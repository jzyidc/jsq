import{_ as fa}from"./_plugin-vue_export-helper-f918498f.js";/* empty css                  *//* empty css                *//* empty css                 *//* empty css               *//* empty css                     *//* empty css                        *//* empty css                       *//* empty css                   *//* empty css               *//* empty css                */import{r as d,a as _a,u as pa,b4 as ma,a9 as K,aa as xe,o as ga,E as f,b as ya,c,d as p,g as a,i as s,w as o,l as h,D as v,aS as ha,k as $,f as D,m as _e,b5 as ba,aO as Le,b6 as ka,p as Ca,aI as wa,b0 as Va,j as _,O as Pe,b7 as pe,F as E,h as A,b8 as Ta,Q as Me,am as Se,aB as $e,R as Ee,aG as Ia,H as Na,b9 as Ae,P as xa,x as Be,N as La,af as Pa,ag as Ma,ba as Sa,q as $a,aU as Ea,aV as Aa,aJ as Ba,az as Ga,aN as qa,bb as Ra,bc as Ua,bd as Da,t as Fa,aZ as za,a2 as Qa,a5 as Oa}from"./index-77fd0c89.js";const Ha={class:"routes-page"},Ka={class:"page-header"},ja={class:"header-content"},Wa={class:"title-section"},Ja={class:"page-title"},Za={class:"stats-info"},Xa={class:"stat-item"},Ya={class:"stat-number"},el={class:"stat-item"},al={class:"stat-number"},ll={class:"main-content"},tl={class:"content-layout"},sl={class:"left-sidebar"},nl={class:"card-header"},ol={class:"region-buttons-vertical"},ul={class:"region-btn-content"},rl={class:"region-name"},il={class:"region-count"},cl={class:"right-content"},dl={class:"filter-assign-layout"},vl={class:"card-header"},fl={class:"filter-section"},_l={class:"filter-item"},pl={class:"filter-item"},ml={class:"filter-item"},gl={class:"filter-section"},yl={class:"filter-item"},hl={class:"filter-item"},bl={class:"card-header"},kl={class:"assign-content"},Cl={class:"assign-input"},wl={class:"assign-input"},Vl={class:"assign-tip"},Tl={class:"card-header"},Il={class:"header-actions"},Nl={class:"page-info"},xl={class:"node-grid"},Ll={class:"node-header"},Pl={class:"node-name"},Ml={class:"node-status"},Sl={class:"node-details"},$l={key:0,class:"detail-item"},El={key:1,class:"detail-item"},Al={class:"detail-item"},Bl={key:2,class:"detail-item"},Gl={key:3,class:"detail-item"},ql={class:"node-footer"},Rl={class:"node-price"},Ul={class:"price-label"},Dl={class:"price-value"},Fl={key:0,class:"quantity-selector"},zl={key:0,class:"pagination-wrapper"},Ql={key:0,class:"icon-badge"},Ol={class:"summary-header"},Hl={class:"summary-content"},Kl={class:"summary-scrollable"},jl={class:"summary-item"},Wl={class:"item-value"},Jl={class:"summary-item"},Zl={class:"item-value"},Xl={class:"summary-item assign-group-item"},Yl={class:"order-list"},et={key:0,class:"empty-order"},at={key:1,class:"order-items"},lt={class:"order-info"},tt={class:"order-name"},st={class:"quantity-control"},nt={class:"order-actions"},ot={class:"order-price"},ut={class:"summary-footer"},rt={class:"summary-total"},it={class:"total-item"},ct={class:"total-value"},dt={class:"total-item price-total"},vt={class:"total-price"},ft={class:"balance-info"},_t={class:"balance-value"},pt={__name:"Routes",setup(mt){d([]);const b=d([]),L=d([]),ue=d(!1),Y=d([{label:"全部",value:""},{label:"A",value:"A"},{label:"B",value:"B"},{label:"C",value:"C"},{label:"D",value:"D"},{label:"E",value:"E"},{label:"F",value:"F"},{label:"G",value:"G"},{label:"H",value:"H"},{label:"I",value:"I"},{label:"J",value:"J"},{label:"K",value:"K"},{label:"L",value:"L"},{label:"M",value:"M"},{label:"N",value:"N"},{label:"O",value:"O"},{label:"P",value:"P"},{label:"Q",value:"Q"},{label:"R",value:"R"},{label:"S",value:"S"},{label:"T",value:"T"},{label:"U",value:"U"},{label:"V",value:"V"},{label:"W",value:"W"},{label:"X",value:"X"},{label:"Y",value:"Y"},{label:"Z",value:"Z"},{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"},{label:"6",value:"6"},{label:"7",value:"7"},{label:"8",value:"8"},{label:"9",value:"9"}]),j=d([...Y.value]),re=d(!1),Ge=["一天","一周","一个月","三个月","半年","一年"],qe=["全部","移动","电信","多线"],ee=d(["全部"]),ae=["全部","福建","四川","广东","河北","江苏","陕西","湖南","甘肃","海南","山西","云南","青海","吉林","广西","黑龙江","宁夏","西藏","辽宁","安徽","直辖市","山东","河南","贵州","浙江","内蒙古","江西","湖北"],ie=d(""),y=d(""),S=d("一个月"),I=d("全部"),k=d("全部");d("中国");const P=d("全部"),W=d(10),B=d(3),F=d(!1),G=d("0000"),me=_a(),le=pa(),V=d(null),z=d(!1),J=()=>{V.value&&clearTimeout(V.value),V.value=setTimeout(()=>{!z.value&&i.value.length===0&&(F.value=!0)},2e3)},Re=()=>{z.value=!0,V.value&&clearTimeout(V.value)},Ue=()=>{z.value=!1,i.value.length===0&&J()},m=ma([]),Q=d(1),te=d(20),ce=d(!1),Z=d(new Map);let X=null;const De=(l,e,n)=>`${l}_${e||"all"}_${n||"all"}`,O=d(new Map),N=K(()=>{try{if(!m.value||!Array.isArray(m.value))return[];const l=`${I.value}_${P.value}_${k.value}_${m.value.length}`;if(O.value.has(l))return O.value.get(l);const e=m.value.filter(n=>{if(!n)return!1;const r=I.value==="全部"||n.operator===I.value;let u=P.value==="全部";!u&&P.value&&n.region&&(u=n.region.includes(P.value)||P.value.includes(n.region));const x=k.value==="全部"||n.type===k.value;return r&&u&&x});return O.value.set(l,e),e}catch(l){return console.error("过滤节点时出错:",l),[]}}),ge=K(()=>{try{if(!N.value||!Array.isArray(N.value))return[];const l=(Q.value-1)*te.value,e=l+te.value;return N.value.slice(l,e)}catch(l){return console.error("分页节点时出错:",l),[]}}),ye=K(()=>{try{return!N.value||!Array.isArray(N.value)?1:Math.max(1,Math.ceil(N.value.length/te.value))}catch(l){return console.error("计算总页数时出错:",l),1}}),se=d(new Map),Fe=K(()=>{var l;try{if(!m.value||!Array.isArray(m.value)){const r={};return ae.forEach(u=>{r[u]=0}),r}const e=`nodes_${m.value.length}_${m.value.length>0&&((l=m.value[0])==null?void 0:l.id)||"empty"}`;if(se.value.has(e))return se.value.get(e);const n={};return ae.forEach(r=>{r==="全部"?n[r]=m.value.length:n[r]=m.value.filter(u=>u&&u.region&&(u.region.includes(r)||r.includes(u.region))).length}),se.value.set(e,n),n}catch(e){console.error("计算地区节点数量时出错:",e);const n={};return ae.forEach(r=>{n[r]=0}),n}}),i=d([]),ze=l=>{if(i.value.find(u=>u.id===l.id)){f.warning("该节点已在订单中");return}const e=T(l.stock);if(e===0){f.error("该节点已售罄，无法加入订单");return}const n=l.selectedQuantity||1;if(n>e){f.warning(`选择数量不能超过剩余库存(${e})`);return}const r={...l,quantity:n};i.value.push(r),f.success(`已添加 ${l.name} 到订单，数量：${n}`)},Qe=l=>{const e=i.value.findIndex(n=>n.id===l.id);e>-1&&(i.value.splice(e,1),f.info(`已从订单中移除 ${l.name}`),i.value.length===0&&!z.value&&J())},de=(l,e)=>{if(!l.priceInfo)return l.price;switch(e){case"一天":return l.priceInfo.day;case"一周":return l.priceInfo.week;case"一个月":return l.priceInfo.month;case"三个月":return l.priceInfo.threeMonth;case"半年":return l.priceInfo.sixMonth;case"一年":return l.priceInfo.year;default:return l.priceInfo.month}},Oe=l=>{switch(l){case"一天":return"日付价格";case"一周":return"周付价格";case"一个月":return"月付价格";case"三个月":return"季付价格";case"半年":return"半年价格";case"一年":return"年付价格";default:return"月付价格"}},he=K(()=>i.value.reduce((l,e)=>l+de(e,S.value)*(e.quantity||1),0)),He=K(()=>i.value.reduce((l,e)=>l+(e.quantity||1),0)),Ke=l=>{const e=T(l.stock);l.quantity<1?l.quantity=1:l.quantity>e&&(l.quantity=e,f.warning(`数量不能超过剩余库存(${e})`)),f.info(`已更新 ${l.name} 的数量为 ${l.quantity}`)},je=()=>{const l=N.value.filter(e=>T(e.stock)>0).sort((e,n)=>{const r=e.stock==="99+"?999:parseInt(e.stock)||0;return(n.stock==="99+"?999:parseInt(n.stock)||0)-r}).slice(0,W.value).map(e=>({...e,quantity:1}));i.value=l,f.success(`已智能分配 ${l.length} 个节点（按库存量优先）`),F.value=!1,V.value&&clearTimeout(V.value)},We=()=>{const l=N.value.filter(g=>T(g.stock)>0);if(l.length===0){f.warning("当前筛选条件下没有可用节点");return}const e={};l.forEach(g=>{const C=g.region||"未知地区";e[C]||(e[C]=[]),e[C].push(g)});const n=Object.keys(e).map(g=>({region:g,nodes:e[g],count:e[g].length})).sort((g,C)=>C.count-g.count);if(n.length<B.value){f.warning(`当前只有 ${n.length} 个地区有可用节点，少于所需的 ${B.value} 个地区`);return}const r=n.slice(0,B.value),u=Math.floor(W.value/B.value),x=W.value%B.value,q=[];r.forEach((g,C)=>{const H=u+(C<x?1:0),ne=g.nodes.sort((M,oe)=>{const fe=M.stock==="99+"?999:parseInt(M.stock)||0;return(oe.stock==="99+"?999:parseInt(oe.stock)||0)-fe}).slice(0,H).map(M=>({...M,quantity:1}));q.push(...ne)}),i.value=q;const R=r.map((g,C)=>{const H=u+(C<x?1:0);return`${g.region}(${H}个)`}).join("、");f.success(`已按地区分配 ${q.length} 个节点：${R}`)},Je=async()=>{if(i.value.length===0){f.warning("请先选择要购买的节点");return}if(!y.value){f.warning("请先选择购买项目");return}if(le.userInfo.balance<he.value){f.warning("账户余额不足，请先充值");return}try{f.info("正在处理支付请求...");const l=i.value.map(n=>({area:n.name,quantity:n.quantity.toString()})),e=await Sa({BuyGame:y.value,BuyTime:S.value,BuyInfo:l,AssignGroup:G.value});if(e.Code===1e3){const n=e.OrderNumber?`支付成功！订单号：${e.OrderNumber}`:"支付成功！节点已添加到您的账户";f.success(n),e.Balance!==void 0?le.updateUserInfo({balance:e.Balance}):await le.getUserInfoAction(),i.value=[],z.value||J(),setTimeout(()=>{me.push("/user/business/list")},1500)}else f.error(e.Msg||"支付失败，请重试")}catch{f.error("支付失败，请检查网络连接后重试")}},Ze=()=>{me.push("/user/recharge")},Xe=()=>{i.value=[],f.info("已重置分配，订单已清空"),z.value||J()},Ye=l=>{if(l==="99+")return"success";const e=parseInt(l);return isNaN(e)||e===0?"danger":e<=5?"warning":"success"},ea=l=>{if(l==="99+")return"充足";const e=parseInt(l);return isNaN(e)||e===0?"售罄":e<=5?"紧张":"充足"},T=l=>{if(l==="99+")return 20;const e=parseInt(l);return isNaN(e)||e<=0?0:Math.min(e,20)},aa=l=>i.value.find(e=>e.id===l.id)?"已添加":T(l.stock)===0?"售罄":"加入订单",la=l=>{const e=l.replace(/[^0-9]/g,"");e.length>4?G.value=e.slice(0,4):G.value=e,parseInt(G.value||"0")>9999&&(G.value="9999")},be=()=>{F.value=!F.value,V.value&&clearTimeout(V.value)},ke=async(l="")=>{try{const e=await ba(l);e&&e.Code===1e3&&e.List?(b.value=Array.isArray(e.List)?e.List:[],L.value=[...b.value],y.value="",b.value.length>0&&b.value[0]&&b.value[0].Game&&(y.value=b.value[0].Game,Le(()=>{y.value&&ve()}))):(f.error("获取游戏数据失败"),b.value=[],L.value=[])}catch(e){console.error("获取游戏数据失败:",e),f.error("获取游戏数据失败"),b.value=[],L.value=[]}},ve=async()=>{if(!y.value){m.value=[];return}const l=De(y.value,I.value,k.value);if(Z.value.has(l)){m.value=Z.value.get(l);return}ce.value=!0;try{const e={GameName:y.value};I.value&&I.value!=="全部"&&(e.ScreenIsp=I.value),k.value&&k.value!=="全部"&&(e.ScreenType=k.value);const n=await ka(e);if(n.Code===1e3)if(n.List&&n.List.length>0){n.ScreenTypeList&&n.ScreenTypeList.length>0&&ee.value.length===1&&(ee.value=["全部",...n.ScreenTypeList],ee.value.includes(k.value)||(k.value="全部"));const r=n.List.map((u,x)=>u?{id:u.Id||x+1,name:u.Area||"",stock:u.Count>99?"99+":u.Count.toString(),price:u.Price_Moon||u.Price||0,operator:u.Isp||"",region:u.Province||"",priceInfo:{day:u.Price_Day||0,week:u.Price_Week||0,month:u.Price_Moon||u.Price||0,threeMonth:u.Price_Three_Moon_Price||0,sixMonth:u.Price_Six_Moon_Price||0,year:u.Price_year_Price||0},type:u.Type||"",effective:u.Effective||"",stability:u.Stability||"",selectedQuantity:1}:null).filter(Boolean);Z.value.set(l,r),m.value=r}else f.warning("暂无可用节点"),m.value=[];else f.error("获取节点数据失败"),m.value=[]}catch{f.error("获取节点数据失败"),m.value=[]}finally{ce.value=!1}},ta=()=>{X&&clearTimeout(X),X=setTimeout(()=>{ve()},200)},sa=()=>{Z.value.clear(),L.value=[],ke(ie.value)},na=()=>{y.value&&ve()},oa=l=>{ue.value=!0,setTimeout(()=>{l?L.value=b.value.filter(e=>e.Game&&e.Game.toLowerCase().includes(l.toLowerCase())):L.value=[...b.value],ue.value=!1},200)},ua=()=>{L.value.length===0&&b.value.length>0&&(L.value=[...b.value])},ra=l=>{re.value=!0,setTimeout(()=>{l?j.value=Y.value.filter(e=>e.label.toLowerCase().includes(l.toLowerCase())||e.value.toLowerCase().includes(l.toLowerCase())):j.value=[...Y.value],re.value=!1},200)},ia=()=>{j.value.length===0&&(j.value=[...Y.value])},ca=l=>{Q.value=l,Le(()=>{const e=document.querySelector(".nodes-card");e&&e.scrollIntoView({behavior:"smooth",block:"start"})})},Ce=()=>{Q.value=1};return xe([y,I,k],()=>{y.value&&(O.value.clear(),Ce(),ta())},{deep:!0}),xe(P,()=>{O.value.clear(),Ce()}),ga(()=>{try{ke(),i.value.length===0&&J()}catch(l){console.error("组件初始化失败:",l),f.error("页面初始化失败，请刷新重试")}}),ya(()=>{V.value&&clearTimeout(V.value),X&&clearTimeout(X),Z.value.clear(),O.value.clear(),se.value.clear()}),(l,e)=>{var Ve,Te,Ie,Ne;const n=Ca,r=$a,u=wa,x=Ea,q=Aa,R=Ba,g=Ga,C=qa,H=Ra,ne=Ua,M=Da,oe=Fa,fe=za,we=Qa,da=Oa,va=Va;return c(),p("div",Ha,[a("div",Ka,[a("div",ja,[a("div",Wa,[a("h1",Ja,[s(n,{class:"title-icon"},{default:o(()=>[s(_(Pe))]),_:1}),e[9]||(e[9]=h(" 项目线路购买 "))]),e[10]||(e[10]=a("p",{class:"page-subtitle"},"选择适合您的线路节点，享受稳定高速的网络服务",-1))]),a("div",Za,[a("div",Xa,[a("span",Ya,v(((Ve=ge.value)==null?void 0:Ve.length)||0),1),e[11]||(e[11]=a("span",{class:"stat-label"},"可用节点",-1))]),a("div",el,[a("span",al,v(((Te=i.value)==null?void 0:Te.length)||0),1),e[12]||(e[12]=a("span",{class:"stat-label"},"已选择",-1))])])])]),a("div",ll,[a("div",tl,[a("div",sl,[s(u,{class:"region-card",shadow:"hover"},{header:o(()=>[a("div",nl,[s(n,null,{default:o(()=>[s(_(pe))]),_:1}),e[13]||(e[13]=a("span",null,"地区选择",-1))])]),default:o(()=>[a("div",ol,[(c(!0),p(E,null,A(ae||[],t=>(c(),$(r,{key:t,type:P.value===t?"primary":"default",class:_e([{"region-active":P.value===t},"region-btn-vertical"]),onClick:U=>P.value=t},{default:o(()=>[a("div",ul,[a("span",rl,v(t),1),a("span",il,"("+v(Fe.value[t]||0)+")",1)])]),_:2},1032,["type","class","onClick"]))),128))])]),_:1})]),a("div",cl,[a("div",dl,[s(u,{class:"filter-card",shadow:"hover"},{header:o(()=>[a("div",vl,[s(n,null,{default:o(()=>[s(_(Ta))]),_:1}),e[14]||(e[14]=a("span",null,"筛选条件",-1))])]),default:o(()=>[a("div",fl,[s(g,{gutter:20},{default:o(()=>[s(R,{span:8},{default:o(()=>[a("div",_l,[e[15]||(e[15]=a("label",{class:"filter-label"},[h("游戏首字母 "),a("span",{style:{color:"#909399","font-size":"12px"}},"(支持搜索)")],-1)),s(q,{modelValue:ie.value,"onUpdate:modelValue":e[0]||(e[0]=t=>ie.value=t),class:"filter-select",placeholder:"请选择首字母或输入关键词搜索",filterable:"",remote:"","remote-method":ra,loading:re.value,onChange:sa,onFocus:ia},{prefix:o(()=>[s(n,null,{default:o(()=>[s(_(Me))]),_:1})]),default:o(()=>[(c(!0),p(E,null,A(j.value,t=>(c(),$(x,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])])]),_:1}),s(R,{span:8},{default:o(()=>[a("div",pl,[e[16]||(e[16]=a("label",{class:"filter-label"},[h("购买项目 "),a("span",{style:{color:"#909399","font-size":"12px"}},"(支持搜索)")],-1)),s(q,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=t=>y.value=t),class:"filter-select",placeholder:"请选择游戏或输入关键词搜索",filterable:"",remote:"","remote-method":oa,loading:ue.value,onChange:na,onFocus:ua},{prefix:o(()=>[s(n,null,{default:o(()=>[s(_(Me))]),_:1})]),default:o(()=>[(c(!0),p(E,null,A(L.value||[],t=>(c(),$(x,{key:t.Id,label:t.Game,value:t.Game},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])])]),_:1}),s(R,{span:8},{default:o(()=>[a("div",ml,[e[17]||(e[17]=a("label",{class:"filter-label"},"购买时长",-1)),s(q,{modelValue:S.value,"onUpdate:modelValue":e[2]||(e[2]=t=>S.value=t),class:"filter-select"},{default:o(()=>[(c(!0),p(E,null,A(Ge||[],t=>(c(),$(x,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),s(C,null,{default:o(()=>[s(n,null,{default:o(()=>[s(_(Se))]),_:1}),e[18]||(e[18]=h("高级筛选"))]),_:1,__:[18]}),a("div",gl,[s(g,{gutter:20},{default:o(()=>[s(R,{span:12},{default:o(()=>[a("div",yl,[e[19]||(e[19]=a("label",{class:"filter-label"},"运营商",-1)),s(ne,{modelValue:I.value,"onUpdate:modelValue":e[3]||(e[3]=t=>I.value=t),class:"filter-radio"},{default:o(()=>[(c(!0),p(E,null,A(qe||[],t=>(c(),$(H,{key:t,value:t},{default:o(()=>[h(v(t),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])]),_:1}),s(R,{span:12},{default:o(()=>[a("div",hl,[e[20]||(e[20]=a("label",{class:"filter-label"},"线路类型",-1)),s(ne,{modelValue:k.value,"onUpdate:modelValue":e[4]||(e[4]=t=>k.value=t),class:"filter-radio"},{default:o(()=>[(c(!0),p(E,null,A(ee.value||[],t=>(c(),$(H,{key:t,value:t},{default:o(()=>[h(v(t),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1})])]),_:1}),s(u,{class:"assign-card",shadow:"hover"},{header:o(()=>[a("div",bl,[s(n,null,{default:o(()=>[s(_(Se))]),_:1}),e[21]||(e[21]=a("span",null,"智能分配",-1))])]),default:o(()=>[a("div",kl,[a("div",Cl,[e[24]||(e[24]=a("label",{class:"assign-label"},"节点数量：",-1)),s(M,{modelValue:W.value,"onUpdate:modelValue":e[5]||(e[5]=t=>W.value=t),min:1,max:999,class:"node-counter"},null,8,["modelValue"]),s(r,{type:"primary",onClick:je,class:"assign-btn"},{default:o(()=>[s(n,null,{default:o(()=>[s(_($e))]),_:1}),e[22]||(e[22]=h(" 智能分配 "))]),_:1,__:[22]}),s(r,{type:"warning",onClick:Xe,class:"assign-btn",disabled:i.value.length===0},{default:o(()=>[s(n,null,{default:o(()=>[s(_(Ee))]),_:1}),e[23]||(e[23]=h(" 重置分配 "))]),_:1,__:[23]},8,["disabled"])]),a("div",wl,[e[26]||(e[26]=a("label",{class:"assign-label"},"地区分配：",-1)),s(M,{modelValue:B.value,"onUpdate:modelValue":e[6]||(e[6]=t=>B.value=t),min:1,max:10,class:"node-counter"},null,8,["modelValue"]),s(r,{type:"success",onClick:We,class:"assign-btn"},{default:o(()=>[s(n,null,{default:o(()=>[s(_(pe))]),_:1}),e[25]||(e[25]=h(" 地区分配 "))]),_:1,__:[25]}),e[27]||(e[27]=a("span",{class:"assign-desc"},"按地区平均分配节点",-1))]),a("div",Vl,[s(n,null,{default:o(()=>[s(_(Ia))]),_:1}),e[28]||(e[28]=a("span",null,"智能分配：按库存优先选择节点；地区分配：选择指定数量地区，平均分配节点",-1))])])]),_:1})]),ha((c(),$(u,{class:"nodes-card",shadow:"hover"},{header:o(()=>{var t;return[a("div",Tl,[s(n,null,{default:o(()=>[s(_(Na))]),_:1}),a("span",null,"可用节点 ("+v(((t=N.value)==null?void 0:t.length)||0)+")",1),a("div",Il,[a("span",Nl,"第 "+v(Q.value)+" / "+v(ye.value)+" 页",1)])])]}),default:o(()=>[a("div",xl,[(c(!0),p(E,null,A(ge.value||[],t=>{var U;return c(),p("div",{key:t.id,class:_e(["node-item",{"node-selected":(U=i.value)==null?void 0:U.find(w=>w.id===t.id),"node-sold-out":T(t.stock)===0}])},[a("div",Ll,[a("div",Pl,v(t.name),1),a("div",Ml,[s(oe,{type:Ye(t.stock),size:"small"},{default:o(()=>[h(v(ea(t.stock)),1)]),_:2},1032,["type"])])]),a("div",Sl,[t.operator?(c(),p("div",$l,[s(n,null,{default:o(()=>[s(_(Pe))]),_:1}),a("span",null,v(t.operator),1)])):D("",!0),t.region?(c(),p("div",El,[s(n,null,{default:o(()=>[s(_(pe))]),_:1}),a("span",null,v(t.region),1)])):D("",!0),a("div",Al,[s(n,null,{default:o(()=>[s(_(Ae))]),_:1}),a("span",null,"剩余: "+v(t.stock),1)]),t.type?(c(),p("div",Bl,[s(n,null,{default:o(()=>[s(_($e))]),_:1}),a("span",null,v(t.type),1)])):D("",!0),t.stability?(c(),p("div",Gl,[s(n,null,{default:o(()=>[s(_(xa))]),_:1}),a("span",null,v(t.stability),1)])):D("",!0)]),a("div",ql,[a("div",Rl,[a("span",Ul,v(Oe(S.value)),1),a("span",Dl,"￥"+v(de(t,S.value)),1)]),!i.value.find(w=>w.id===t.id)&&T(t.stock)>0?(c(),p("div",Fl,[e[29]||(e[29]=a("span",{class:"quantity-label"},"数量：",-1)),s(M,{modelValue:t.selectedQuantity,"onUpdate:modelValue":w=>t.selectedQuantity=w,min:1,max:T(t.stock),size:"small",class:"quantity-input-node"},null,8,["modelValue","onUpdate:modelValue","max"])])):D("",!0),s(r,{type:i.value.find(w=>w.id===t.id)?"success":T(t.stock)===0?"info":"primary",icon:i.value.find(w=>w.id===t.id)?"Check":"Plus",disabled:T(t.stock)===0&&!i.value.find(w=>w.id===t.id),onClick:w=>ze(t),class:"add-btn"},{default:o(()=>[h(v(aa(t)),1)]),_:2},1032,["type","icon","disabled","onClick"])])],2)}),128))]),ye.value>1?(c(),p("div",zl,[s(fe,{"current-page":Q.value,"onUpdate:currentPage":e[7]||(e[7]=t=>Q.value=t),"page-size":te.value,total:N.value.length,layout:"prev, pager, next, jumper","hide-on-single-page":!1,size:"small",onCurrentChange:ca},null,8,["current-page","page-size","total"])])):D("",!0)]),_:1})),[[va,ce.value]])])])]),a("div",{class:_e(["order-summary",{"order-summary-hidden":F.value}]),onMouseenter:Re,onMouseleave:Ue},[F.value?(c(),p("div",{key:0,class:"summary-icon",onClick:be},[s(n,{class:"cart-icon"},{default:o(()=>[s(_(Be))]),_:1}),((Ie=i.value)==null?void 0:Ie.length)>0?(c(),p("div",Ql,v(((Ne=i.value)==null?void 0:Ne.length)||0),1)):D("",!0),e[30]||(e[30]=a("div",{class:"icon-tooltip"},"订单汇总",-1))])):(c(),$(u,{key:1,class:"summary-card",shadow:"always"},{header:o(()=>[a("div",Ol,[s(n,null,{default:o(()=>[s(_(Be))]),_:1}),e[31]||(e[31]=a("span",null,"订单汇总",-1)),s(r,{link:"",class:"toggle-btn",onClick:be},{default:o(()=>[s(n,null,{default:o(()=>[s(_(La))]),_:1})]),_:1})])]),default:o(()=>[a("div",Hl,[a("div",Kl,[a("div",jl,[e[32]||(e[32]=a("span",{class:"item-label"},"选择项目：",-1)),a("span",Wl,v(y.value),1)]),a("div",Jl,[e[33]||(e[33]=a("span",{class:"item-label"},"购买时长：",-1)),a("span",Zl,v(S.value),1)]),a("div",Xl,[e[34]||(e[34]=a("span",{class:"item-label"},"分组：",-1)),s(we,{modelValue:G.value,"onUpdate:modelValue":e[8]||(e[8]=t=>G.value=t),placeholder:"0000-9999",maxlength:"4",class:"assign-group-input",onInput:la},null,8,["modelValue"])]),s(C),a("div",Yl,[e[37]||(e[37]=a("div",{class:"list-header"},"已选线路：",-1)),i.value.length===0?(c(),p("div",et,[s(n,null,{default:o(()=>[s(_(Ae))]),_:1}),e[35]||(e[35]=a("span",null,"暂未选择任何线路",-1))])):(c(),p("div",at,[(c(!0),p(E,null,A(i.value||[],t=>(c(),p("div",{key:t.id,class:"order-item"},[a("div",lt,[a("span",tt,v(t.name),1),a("div",st,[e[36]||(e[36]=a("span",{class:"quantity-label"},"数量：",-1)),s(M,{modelValue:t.quantity,"onUpdate:modelValue":U=>t.quantity=U,min:1,max:T(t.stock),size:"small",class:"quantity-input",onChange:U=>Ke(t)},null,8,["modelValue","onUpdate:modelValue","max","onChange"])])]),a("div",nt,[a("span",ot,"￥"+v((de(t,S.value)*t.quantity).toFixed(2)),1),s(r,{link:"",size:"small",onClick:U=>Qe(t),class:"remove-btn"},{default:o(()=>[s(n,null,{default:o(()=>[s(_(Ee))]),_:1})]),_:2},1032,["onClick"])])]))),128))]))])]),a("div",ut,[a("div",rt,[a("div",it,[e[38]||(e[38]=a("span",{class:"total-label"},"总数量：",-1)),a("span",ct,v(He.value)+" 个",1)]),a("div",dt,[e[39]||(e[39]=a("span",{class:"total-label"},"需支付：",-1)),a("span",vt,"￥"+v(he.value.toFixed(2)),1)])]),a("div",ft,[e[41]||(e[41]=a("span",{class:"balance-label"},"账户余额：",-1)),a("span",_t,"￥"+v((_(le).userInfo.balance||0).toFixed(2)),1),s(da,{type:"primary",underline:"never",class:"recharge-link",onClick:Ze},{default:o(()=>[s(n,null,{default:o(()=>[s(_(Pa))]),_:1}),e[40]||(e[40]=h(" 去充值 "))]),_:1,__:[40]})]),s(r,{type:"primary",size:"large",class:"pay-btn",disabled:i.value.length===0,onClick:Je},{default:o(()=>[s(n,null,{default:o(()=>[s(_(Ma))]),_:1}),e[42]||(e[42]=h(" 立即支付 "))]),_:1,__:[42]},8,["disabled"])])])]),_:1}))],34)])}}},Lt=fa(pt,[["__scopeId","data-v-07afdfd0"]]);export{Lt as default};
