import{_ as D}from"./_plugin-vue_export-helper-e4601500.js";/* empty css                   *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                     *//* empty css               *//* empty css                *//* empty css               */import{$ as k,r as w,o as I,c as P,d as R,i as e,w as o,bt as L,E as c,u as $,aH as j,aA as z,g as s,j as _,z as O,D as r,ag as Q,bu as G,aG as H,l as v,bv as W,aF as X,bw as J,al as K,v as Y,ar as Z,aN as tt,p as st,aI as et,az as ot,aW as lt,t as at,aX as nt,q as it,a2 as dt,bx as rt}from"./index-8dfd10b0.js";import{b as ut}from"./browser-9d43139f.js";const ct={class:"agent-promotion-container"},_t={class:"promotion-content"},mt={class:"stat-item"},vt={class:"stat-icon"},ft={class:"stat-content"},pt={class:"stat-value"},yt={class:"stat-item"},gt={class:"stat-icon"},bt={class:"stat-content"},ht={class:"stat-value"},xt={class:"stat-item"},wt={class:"stat-icon"},Ct={class:"stat-content"},kt={class:"stat-value"},Et={class:"stat-item"},At={class:"stat-icon"},Nt={class:"stat-content"},Vt={class:"stat-value"},Ft={class:"details-section"},Ut={class:"detail-item"},qt={class:"detail-value confirming"},Mt={class:"detail-item"},Tt={class:"detail-value unsettled"},St={class:"detail-item"},Bt={class:"detail-value current-month"},Dt={class:"detail-item"},It={class:"detail-value today"},Pt={class:"detail-item"},Rt={class:"detail-value last-month"},Lt={class:"detail-item"},$t={class:"detail-value year"},jt={class:"rules-content"},zt={class:"link-content"},Ot={class:"link-tip"},Qt={class:"link-actions"},Gt={class:"qr-code-container"},Ht={class:"qr-code-wrapper"},Wt={class:"qr-code-info"},Xt={class:"dialog-footer"},Jt={__name:"AgentPromotion",setup(Kt){const g=k({totalUsers:0,totalCommission:"0.00",availableCommission:"0.00",monthlyUsers:0}),b=k({confirmingAmount:"0.00",unsettledAmount:"0.00",currentMonthAmount:"0.00"}),h=k({todayNum:0,lastMonthNum:0,yearNum:0}),n=w(""),x=w(!1),C=w(null),N=w([{level:"一级代理",condition:"直接推广用户",rate:10,description:"用户通过您的链接注册并充值时，您可获得其充值金额10%的佣金"},{level:"二级代理",condition:"推广用户≥10人",rate:15,description:"当您推广的用户达到10人时，佣金比例提升至15%"},{level:"三级代理",condition:"推广用户≥50人",rate:20,description:"当您推广的用户达到50人时，佣金比例提升至20%"}]),V=async()=>{var l,t,i,a,f;try{const d=await L();if(d.code===1e3){const{my_user_info:u,my_commission_info:p}=d;Object.assign(g,{totalUsers:u.total_num||0,totalCommission:((l=p.total_amount)==null?void 0:l.toFixed(2))||"0.00",availableCommission:((t=p.settled_amount)==null?void 0:t.toFixed(2))||"0.00",monthlyUsers:u.month_num||0}),Object.assign(b,{confirmingAmount:((i=p.confirming_amount)==null?void 0:i.toFixed(2))||"0.00",unsettledAmount:((a=p.unsettled_amount)==null?void 0:a.toFixed(2))||"0.00",currentMonthAmount:((f=p.current_month_amount)==null?void 0:f.toFixed(2))||"0.00"}),Object.assign(h,{todayNum:u.today_num||0,lastMonthNum:u.last_month_num||0,yearNum:u.year_num||0})}else c.error(d.msg||"获取统计数据失败")}catch(d){console.error("获取推广统计失败:",d),c.error("获取统计数据失败")}},F=async()=>{try{const t=$().userInfo.phone||"USER";n.value=`${window.location.origin}/register?ref=${t}`}catch{c.error("获取推广链接失败")}},E=async()=>{try{if(navigator.clipboard&&window.isSecureContext){await navigator.clipboard.writeText(n.value),c.success("推广链接已复制到剪贴板");return}const l=document.createElement("textarea");l.value=n.value,l.style.position="fixed",l.style.left="-999999px",l.style.top="-999999px",document.body.appendChild(l),l.focus(),l.select();const t=document.execCommand("copy");if(document.body.removeChild(l),t)c.success("推广链接已复制到剪贴板");else throw new Error("复制命令执行失败")}catch(l){console.error("复制失败:",l),Z.alert(`复制失败，请手动复制以下链接：

${n.value}`,"手动复制",{confirmButtonText:"我知道了",type:"warning",showClose:!1})}},U=async()=>{if(!n.value){c.warning("推广链接为空，无法生成二维码");return}x.value=!0,await tt();try{const l=C.value;l&&await ut.toCanvas(l,n.value,{width:200,height:200,margin:2,color:{dark:"#000000",light:"#FFFFFF"}})}catch(l){console.error("生成二维码失败:",l),c.error("生成二维码失败")}},q=()=>{const l=C.value;if(l){const t=document.createElement("a");t.download="推广链接二维码.png",t.href=l.toDataURL(),t.click(),c.success("二维码已下载")}else c.error("二维码未生成，无法下载")},M=()=>{c.info("分享功能开发中...")};return I(()=>{V(),F()}),(l,t)=>{const i=st,a=et,f=ot,d=j,u=lt,p=at,T=nt,y=it,A=dt,S=rt,B=z;return P(),R("div",ct,[e(d,{class:"promotion-card"},{header:o(()=>t[4]||(t[4]=[s("div",{class:"card-header"},[s("h3",null,"代理推广"),s("p",null,"通过推广获得佣金收益")],-1)])),default:o(()=>[s("div",_t,[e(f,{gutter:20,class:"stats-row"},{default:o(()=>[e(a,{xs:24,sm:12,md:6},{default:o(()=>[s("div",mt,[s("div",vt,[e(i,null,{default:o(()=>[e(_(O))]),_:1})]),s("div",ft,[s("div",pt,r(g.totalUsers),1),t[5]||(t[5]=s("div",{class:"stat-label"},"推广用户数",-1))])])]),_:1}),e(a,{xs:24,sm:12,md:6},{default:o(()=>[s("div",yt,[s("div",gt,[e(i,null,{default:o(()=>[e(_(Q))]),_:1})]),s("div",bt,[s("div",ht,"¥"+r(g.totalCommission),1),t[6]||(t[6]=s("div",{class:"stat-label"},"累计佣金",-1))])])]),_:1}),e(a,{xs:24,sm:12,md:6},{default:o(()=>[s("div",xt,[s("div",wt,[e(i,null,{default:o(()=>[e(_(G))]),_:1})]),s("div",Ct,[s("div",kt,"¥"+r(g.availableCommission),1),t[7]||(t[7]=s("div",{class:"stat-label"},"已结算佣金",-1))])])]),_:1}),e(a,{xs:24,sm:12,md:6},{default:o(()=>[s("div",Et,[s("div",At,[e(i,null,{default:o(()=>[e(_(H))]),_:1})]),s("div",Nt,[s("div",Vt,r(g.monthlyUsers),1),t[8]||(t[8]=s("div",{class:"stat-label"},"本月新增",-1))])])]),_:1})]),_:1}),s("div",Ft,[e(d,{class:"commission-details-card",shadow:"never"},{header:o(()=>t[9]||(t[9]=[s("h4",null,"佣金详情",-1)])),default:o(()=>[e(f,{gutter:20},{default:o(()=>[e(a,{xs:24,sm:8},{default:o(()=>[s("div",Ut,[t[10]||(t[10]=s("div",{class:"detail-label"},"确认中金额",-1)),s("div",qt,"¥"+r(b.confirmingAmount),1)])]),_:1}),e(a,{xs:24,sm:8},{default:o(()=>[s("div",Mt,[t[11]||(t[11]=s("div",{class:"detail-label"},"未结算金额",-1)),s("div",Tt,"¥"+r(b.unsettledAmount),1)])]),_:1}),e(a,{xs:24,sm:8},{default:o(()=>[s("div",St,[t[12]||(t[12]=s("div",{class:"detail-label"},"当月佣金",-1)),s("div",Bt,"¥"+r(b.currentMonthAmount),1)])]),_:1})]),_:1})]),_:1}),e(d,{class:"user-stats-card",shadow:"never"},{header:o(()=>t[13]||(t[13]=[s("h4",null,"用户统计详情",-1)])),default:o(()=>[e(f,{gutter:20},{default:o(()=>[e(a,{xs:24,sm:8},{default:o(()=>[s("div",Dt,[t[14]||(t[14]=s("div",{class:"detail-label"},"今日新增",-1)),s("div",It,r(h.todayNum)+"人",1)])]),_:1}),e(a,{xs:24,sm:8},{default:o(()=>[s("div",Pt,[t[15]||(t[15]=s("div",{class:"detail-label"},"上月新增",-1)),s("div",Rt,r(h.lastMonthNum)+"人",1)])]),_:1}),e(a,{xs:24,sm:8},{default:o(()=>[s("div",Lt,[t[16]||(t[16]=s("div",{class:"detail-label"},"本年新增",-1)),s("div",$t,r(h.yearNum)+"人",1)])]),_:1})]),_:1})]),_:1})]),e(f,{gutter:20,class:"rules-link-row"},{default:o(()=>[e(a,{xs:24,lg:14},{default:o(()=>[e(d,{class:"commission-rules-card",shadow:"never"},{header:o(()=>t[17]||(t[17]=[s("h4",null,"佣金规则",-1)])),default:o(()=>[s("div",jt,[e(T,{data:N.value,style:{width:"100%"}},{default:o(()=>[e(u,{prop:"level",label:"推广等级",width:"120"}),e(u,{prop:"condition",label:"达成条件"}),e(u,{prop:"rate",label:"佣金比例",width:"120"},{default:o(m=>[e(p,{type:"success"},{default:o(()=>[v(r(m.row.rate)+"%",1)]),_:2},1024)]),_:1}),e(u,{prop:"description",label:"说明"})]),_:1},8,["data"])])]),_:1})]),_:1}),e(a,{xs:24,lg:10},{default:o(()=>[e(d,{class:"promotion-link-card",shadow:"never"},{header:o(()=>t[18]||(t[18]=[s("h4",null,"我的推广链接",-1)])),default:o(()=>[s("div",zt,[e(A,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=m=>n.value=m),readonly:"",class:"link-input",placeholder:"推广链接生成中..."},{append:o(()=>[e(y,{onClick:E,type:"primary",disabled:!n.value},{default:o(()=>[e(i,null,{default:o(()=>[e(_(W))]),_:1}),t[19]||(t[19]=v(" 复制链接 "))]),_:1,__:[19]},8,["disabled"])]),_:1},8,["modelValue"]),s("div",Ot,[e(S,{size:"small",type:"info"},{default:o(()=>[e(i,null,{default:o(()=>[e(_(X))]),_:1}),t[20]||(t[20]=v(" 如果复制失败，请手动选择链接文本进行复制 "))]),_:1,__:[20]})]),s("div",Qt,[e(y,{onClick:U,type:"success"},{default:o(()=>[e(i,null,{default:o(()=>[e(_(J))]),_:1}),t[21]||(t[21]=v(" 生成二维码 "))]),_:1,__:[21]}),e(y,{onClick:M,type:"info"},{default:o(()=>[e(i,null,{default:o(()=>[e(_(K))]),_:1}),t[22]||(t[22]=v(" 分享链接 "))]),_:1,__:[22]})])])]),_:1})]),_:1})]),_:1})])]),_:1}),e(B,{modelValue:x.value,"onUpdate:modelValue":t[3]||(t[3]=m=>x.value=m),title:"推广链接二维码",width:"400px","align-center":""},{footer:o(()=>[s("div",Xt,[e(y,{onClick:q,type:"success"},{default:o(()=>[e(i,null,{default:o(()=>[e(_(Y))]),_:1}),t[25]||(t[25]=v(" 下载二维码 "))]),_:1,__:[25]}),e(y,{onClick:t[2]||(t[2]=m=>x.value=!1)},{default:o(()=>t[26]||(t[26]=[v("关闭")])),_:1,__:[26]})])]),default:o(()=>[s("div",Gt,[s("div",Ht,[s("canvas",{ref_key:"qrCodeCanvas",ref:C,class:"qr-code-canvas"},null,512)]),s("div",Wt,[t[24]||(t[24]=s("p",{class:"qr-code-text"},"扫描二维码或复制链接分享给好友",-1)),e(A,{modelValue:n.value,"onUpdate:modelValue":t[1]||(t[1]=m=>n.value=m),readonly:"",class:"qr-link-input"},{append:o(()=>[e(y,{onClick:E,type:"primary",size:"small",disabled:!n.value},{default:o(()=>t[23]||(t[23]=[v(" 复制 ")])),_:1,__:[23]},8,["disabled"])]),_:1},8,["modelValue"])])])]),_:1},8,["modelValue"])])}}},us=D(Jt,[["__scopeId","data-v-6d668411"]]);export{us as default};
