import{_ as de}from"./_plugin-vue_export-helper-e4601500.js";/* empty css                  *//* empty css                   *//* empty css                     *//* empty css                       *//* empty css                 *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                *//* empty css               */import{r as c,a0 as B,o as me,ab as E,c as D,d as pe,i as e,w as l,E as p,ap as ce,as as _e,a1 as ge,l as n,at as fe,k as A,B as T,g as N,f as ve,af as P,p as be,a3 as ye,ao as we,au as Ve,av as xe,q as he,an as Ce,aw as Ee,X as Te,t as ke,ax as Ue,ay as Se,a4 as ze,az as Be,aA as De,a2 as Pe,aB as $e}from"./index-53bb2135.js";const Le={class:"user-manage"},Fe={class:"pagination-container"},Ie={class:"dialog-footer"},Me={__name:"UserManage",setup(Re){const k=c(!1),U=c(!1),_=c(!1),S=c(""),b=c(),y=c([]),g=B({keyword:"",role:"",status:""}),i=B({currentPage:1,pageSize:20,total:0}),u=c([{id:1,username:"admin",email:"admin@example.com",phone:"13800138000",role:"admin",status:"active",avatar:"",createTime:"2024-01-01 10:00:00",lastLoginTime:"2024-01-15 09:30:00"},{id:2,username:"user001",email:"user001@example.com",phone:"13800138001",role:"user",status:"active",avatar:"",createTime:"2024-01-02 14:20:00",lastLoginTime:"2024-01-14 16:45:00"},{id:3,username:"user002",email:"user002@example.com",phone:"13800138002",role:"user",status:"inactive",avatar:"",createTime:"2024-01-03 09:15:00",lastLoginTime:"2024-01-10 11:20:00"}]),s=B({id:null,username:"",email:"",phone:"",role:"user",status:"active",password:""}),j={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],phone:[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]},$=()=>{i.currentPage=1,C()},C=async()=>{k.value=!0;try{await new Promise(o=>setTimeout(o,500)),i.total=u.value.length}catch{p.error("获取用户列表失败")}finally{k.value=!1}},O=()=>{S.value="添加用户",L(),_.value=!0},K=o=>{S.value="编辑用户",Object.assign(s,{...o,password:""}),_.value=!0},G=o=>{P.confirm(`确定要删除用户 "${o.username}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const a=u.value.findIndex(f=>f.id===o.id);a>-1&&(u.value.splice(a,1),p.success("删除成功"))})},X=o=>{const a=o.status==="active"?"禁用":"启用";P.confirm(`确定要${a}用户 "${o.username}" 吗？`,`确认${a}`,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.status=o.status==="active"?"inactive":"active",p.success(`${a}成功`)})},H=()=>{P.confirm(`确定要删除选中的 ${y.value.length} 个用户吗？`,"确认批量删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const o=y.value.map(a=>a.id);u.value=u.value.filter(a=>!o.includes(a.id)),y.value=[],p.success("批量删除成功")})},J=()=>{p.info("导出功能开发中...")},Q=o=>{y.value=o},W=o=>{i.pageSize=o,C()},Y=o=>{i.currentPage=o,C()},Z=async()=>{if(b.value)try{if(!await b.value.validate())return;if(U.value=!0,await new Promise(a=>setTimeout(a,1e3)),s.id){const a=u.value.findIndex(f=>f.id===s.id);a>-1&&(u.value[a]={...s}),p.success("编辑成功")}else{const a={...s,id:Date.now(),createTime:new Date().toLocaleString(),lastLoginTime:"-"};u.value.unshift(a),p.success("添加成功")}_.value=!1}catch{p.error("操作失败")}finally{U.value=!1}},L=()=>{Object.assign(s,{id:null,username:"",email:"",phone:"",role:"user",status:"active",password:""}),b.value&&b.value.clearValidate()};return me(()=>{C()}),(o,a)=>{const f=E("Search"),w=be,V=ye,x=we,m=Ve,z=xe,d=he,F=Ce,ee=E("Plus"),ae=E("Download"),le=E("Delete"),I=ce,r=Ee,te=Te,M=ke,oe=Ue,se=Se,v=ze,R=Be,ne=De,re=Pe,ie=_e,ue=$e;return D(),pe("div",Le,[e(I,{class:"search-card"},{default:l(()=>[e(F,{gutter:20},{default:l(()=>[e(x,{xs:24,sm:12,md:8},{default:l(()=>[e(V,{modelValue:g.keyword,"onUpdate:modelValue":a[0]||(a[0]=t=>g.keyword=t),placeholder:"搜索用户名、邮箱或手机号",clearable:"",onKeyup:ge($,["enter"])},{prefix:l(()=>[e(w,null,{default:l(()=>[e(f)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(x,{xs:24,sm:12,md:6},{default:l(()=>[e(z,{modelValue:g.role,"onUpdate:modelValue":a[1]||(a[1]=t=>g.role=t),placeholder:"选择角色",clearable:""},{default:l(()=>[e(m,{label:"全部",value:""}),e(m,{label:"管理员",value:"admin"}),e(m,{label:"普通用户",value:"user"})]),_:1},8,["modelValue"])]),_:1}),e(x,{xs:24,sm:12,md:6},{default:l(()=>[e(z,{modelValue:g.status,"onUpdate:modelValue":a[2]||(a[2]=t=>g.status=t),placeholder:"选择状态",clearable:""},{default:l(()=>[e(m,{label:"全部",value:""}),e(m,{label:"正常",value:"active"}),e(m,{label:"禁用",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(x,{xs:24,sm:12,md:4},{default:l(()=>[e(d,{type:"primary",onClick:$},{default:l(()=>[e(w,null,{default:l(()=>[e(f)]),_:1}),a[13]||(a[13]=n(" 搜索 "))]),_:1,__:[13]})]),_:1})]),_:1}),e(F,{class:"action-row"},{default:l(()=>[e(x,null,{default:l(()=>[e(d,{type:"primary",onClick:O},{default:l(()=>[e(w,null,{default:l(()=>[e(ee)]),_:1}),a[14]||(a[14]=n(" 添加用户 "))]),_:1,__:[14]}),e(d,{type:"success",onClick:J},{default:l(()=>[e(w,null,{default:l(()=>[e(ae)]),_:1}),a[15]||(a[15]=n(" 导出数据 "))]),_:1,__:[15]}),e(d,{type:"danger",onClick:H,disabled:y.value.length===0},{default:l(()=>[e(w,null,{default:l(()=>[e(le)]),_:1}),a[16]||(a[16]=n(" 批量删除 "))]),_:1,__:[16]},8,["disabled"])]),_:1})]),_:1})]),_:1}),e(I,{class:"table-card"},{default:l(()=>[fe((D(),A(oe,{data:u.value,onSelectionChange:Q,stripe:"",style:{width:"100%"}},{default:l(()=>[e(r,{type:"selection",width:"55"}),e(r,{prop:"avatar",label:"头像",width:"80"},{default:l(({row:t})=>[e(te,{src:t.avatar,size:40},{default:l(()=>{var h,q;return[n(T((q=(h=t.username)==null?void 0:h.charAt(0))==null?void 0:q.toUpperCase()),1)]}),_:2},1032,["src"])]),_:1}),e(r,{prop:"username",label:"用户名","min-width":"120"}),e(r,{prop:"email",label:"邮箱","min-width":"180"}),e(r,{prop:"phone",label:"手机号","min-width":"120"}),e(r,{prop:"role",label:"角色",width:"100"},{default:l(({row:t})=>[e(M,{type:t.role==="admin"?"danger":"primary"},{default:l(()=>[n(T(t.role==="admin"?"管理员":"普通用户"),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"status",label:"状态",width:"100"},{default:l(({row:t})=>[e(M,{type:t.status==="active"?"success":"danger"},{default:l(()=>[n(T(t.status==="active"?"正常":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"createTime",label:"注册时间",width:"180"}),e(r,{prop:"lastLoginTime",label:"最后登录",width:"180"}),e(r,{label:"操作",width:"200",fixed:"right"},{default:l(({row:t})=>[e(d,{type:"primary",size:"small",onClick:h=>K(t)},{default:l(()=>a[17]||(a[17]=[n(" 编辑 ")])),_:2,__:[17]},1032,["onClick"]),e(d,{type:t.status==="active"?"warning":"success",size:"small",onClick:h=>X(t)},{default:l(()=>[n(T(t.status==="active"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),e(d,{type:"danger",size:"small",onClick:h=>G(t)},{default:l(()=>a[18]||(a[18]=[n(" 删除 ")])),_:2,__:[18]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ue,k.value]]),N("div",Fe,[e(se,{"current-page":i.currentPage,"onUpdate:currentPage":a[3]||(a[3]=t=>i.currentPage=t),"page-size":i.pageSize,"onUpdate:pageSize":a[4]||(a[4]=t=>i.pageSize=t),"page-sizes":[10,20,50,100],total:i.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:W,onCurrentChange:Y},null,8,["current-page","page-size","total"])])]),_:1}),e(ie,{modelValue:_.value,"onUpdate:modelValue":a[12]||(a[12]=t=>_.value=t),title:S.value,width:"600px",onClose:L},{footer:l(()=>[N("div",Ie,[e(d,{onClick:a[11]||(a[11]=t=>_.value=!1)},{default:l(()=>a[21]||(a[21]=[n("取消")])),_:1,__:[21]}),e(d,{type:"primary",onClick:Z,loading:U.value},{default:l(()=>a[22]||(a[22]=[n(" 确定 ")])),_:1,__:[22]},8,["loading"])])]),default:l(()=>[e(re,{ref_key:"userFormRef",ref:b,model:s,rules:j,"label-width":"80px"},{default:l(()=>[e(v,{label:"用户名",prop:"username"},{default:l(()=>[e(V,{modelValue:s.username,"onUpdate:modelValue":a[5]||(a[5]=t=>s.username=t),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(v,{label:"邮箱",prop:"email"},{default:l(()=>[e(V,{modelValue:s.email,"onUpdate:modelValue":a[6]||(a[6]=t=>s.email=t),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),e(v,{label:"手机号",prop:"phone"},{default:l(()=>[e(V,{modelValue:s.phone,"onUpdate:modelValue":a[7]||(a[7]=t=>s.phone=t),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),e(v,{label:"角色",prop:"role"},{default:l(()=>[e(z,{modelValue:s.role,"onUpdate:modelValue":a[8]||(a[8]=t=>s.role=t),placeholder:"请选择角色"},{default:l(()=>[e(m,{label:"普通用户",value:"user"}),e(m,{label:"管理员",value:"admin"})]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"状态",prop:"status"},{default:l(()=>[e(ne,{modelValue:s.status,"onUpdate:modelValue":a[9]||(a[9]=t=>s.status=t)},{default:l(()=>[e(R,{label:"active"},{default:l(()=>a[19]||(a[19]=[n("正常")])),_:1,__:[19]}),e(R,{label:"inactive"},{default:l(()=>a[20]||(a[20]=[n("禁用")])),_:1,__:[20]})]),_:1},8,["modelValue"])]),_:1}),s.id?ve("",!0):(D(),A(v,{key:0,label:"密码",prop:"password"},{default:l(()=>[e(V,{modelValue:s.password,"onUpdate:modelValue":a[10]||(a[10]=t=>s.password=t),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]),_:1}))]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},la=de(Me,[["__scopeId","data-v-dd2b86a1"]]);export{la as default};
