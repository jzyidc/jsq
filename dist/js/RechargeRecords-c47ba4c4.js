import{_ as ae}from"./_plugin-vue_export-helper-f918498f.js";/* empty css                  *//* empty css                   *//* empty css                             *//* empty css                *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css               *//* empty css                       */import{u as le,r as g,$ as se,a9 as M,o as oe,b as ne,c as p,d as U,i as e,w as a,E as S,aI as re,aA as de,g as l,j as f,aQ as ie,ag as L,D as d,ah as ue,aR as ce,aS as _e,k as v,l as u,aT as O,S as pe,f as Y,aU as me,aV as fe,aJ as ve,aW as ge,p as be,q as ye,az as he,aX as Ce,t as xe,aY as ke,aZ as we,a_ as Ee,a$ as De,b0 as ze}from"./index-77fd0c89.js";import{b as Re}from"./finance-a7731777.js";const Ve={class:"records-container"},Se={class:"records-content"},Pe={class:"filter-section"},Me={class:"stats-section"},Ue={class:"stat-card"},Ye={class:"stat-icon success"},$e={class:"stat-content"},Te={class:"stat-value"},Ne={class:"stat-card"},Be={class:"stat-icon primary"},Le={class:"stat-content"},Oe={class:"stat-value"},Ae={class:"stat-card"},Ie={class:"stat-icon warning"},Fe={class:"stat-content"},je={class:"stat-value"},qe={class:"table-section"},Je={class:"order-number"},Qe={class:"amount"},We={class:"time-info"},Xe={class:"time-ago"},Ze={class:"action-buttons"},Ge={key:0,class:"pagination-container"},He={key:0,class:"order-detail"},Ke={class:"order-number"},et={class:"amount"},tt={class:"dialog-footer"},at={__name:"RechargeRecords",setup(lt){le();const E=g(!1),k=g([]),D=g(!1),i=g(null),z=g(""),R=g(""),b=g([]),r=se({currentPage:1,pageSize:10,total:0,pageCount:0}),A=M(()=>k.value.filter(o=>o.api_order_number).reduce((o,t)=>o+parseFloat(t.amount||0),0).toFixed(2)),I=M(()=>k.value.length),F=M(()=>k.value.filter(o=>!o.api_order_number).length),y=async(o=1)=>{E.value=!0;try{const t={page:o,pageSize:r.pageSize};z.value&&(t.status=z.value),R.value&&(t.type=R.value),b.value&&b.value.length===2&&(t.startDate=b.value[0],t.endDate=b.value[1]);const n=await Re(t);n.Code===1e3?(k.value=n.List||[],r.currentPage=n.NowPage||o,r.total=n.RowCount||0,r.pageCount=n.PageCount||0):S.error(n.Message||"加载充值记录失败")}catch(t){console.error("加载充值记录失败:",t),S.error("加载充值记录失败，请稍后重试")}finally{E.value=!1}},j=o=>{y(o)},q=o=>{r.pageSize=o,r.currentPage=1,y(1)},P=()=>{r.currentPage=1,y(1)},J=()=>{y(r.currentPage)},Q=o=>{i.value=o,D.value=!0},$=async o=>{try{await navigator.clipboard.writeText(o),S.success("订单号已复制到剪贴板")}catch{const n=document.createElement("textarea");n.value=o,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),S.success("订单号已复制到剪贴板")}},T=o=>o?new Date(o).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-",W=o=>{if(!o)return"";const t=new Date,n=new Date(o),h=t-n,c=Math.floor(h/(1e3*60)),V=Math.floor(h/(1e3*60*60)),_=Math.floor(h/(1e3*60*60*24));return c<1?"刚刚":c<60?`${c}分钟前`:V<24?`${V}小时前`:_<30?`${_}天前`:"很久以前"},N=()=>{y(r.currentPage)};return oe(()=>{y(),window.addEventListener("recharge-success",N)}),ne(()=>{window.removeEventListener("recharge-success",N)}),(o,t)=>{const n=me,h=fe,c=ve,V=ge,_=be,w=ye,B=he,C=Ce,m=xe,X=ke,Z=we,G=re,x=Ee,H=De,K=de,ee=ze;return p(),U("div",Ve,[e(G,{class:"records-card"},{header:a(()=>t[8]||(t[8]=[l("div",{class:"card-header"},[l("h3",null,"充值记录"),l("p",null,"查看您的所有充值记录和支付状态")],-1)])),default:a(()=>[l("div",Se,[l("div",Pe,[e(B,{gutter:16,class:"filter-row"},{default:a(()=>[e(c,{xs:24,sm:12,md:6,lg:6,xl:6},{default:a(()=>[e(h,{modelValue:z.value,"onUpdate:modelValue":t[0]||(t[0]=s=>z.value=s),placeholder:"支付状态",clearable:"",onChange:P},{default:a(()=>[e(n,{label:"全部",value:""}),e(n,{label:"已支付",value:"paid"}),e(n,{label:"待支付",value:"pending"})]),_:1},8,["modelValue"])]),_:1}),e(c,{xs:24,sm:12,md:6,lg:6,xl:6},{default:a(()=>[e(h,{modelValue:R.value,"onUpdate:modelValue":t[1]||(t[1]=s=>R.value=s),placeholder:"支付方式",clearable:"",onChange:P},{default:a(()=>[e(n,{label:"全部",value:""}),e(n,{label:"支付宝",value:"支付宝"}),e(n,{label:"微信",value:"微信"})]),_:1},8,["modelValue"])]),_:1}),e(c,{xs:24,sm:16,md:8,lg:8,xl:8},{default:a(()=>[e(V,{modelValue:b.value,"onUpdate:modelValue":t[2]||(t[2]=s=>b.value=s),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:P,class:"mobile-date-picker"},null,8,["modelValue"])]),_:1}),e(c,{xs:24,sm:8,md:4,lg:4,xl:4},{default:a(()=>[e(w,{type:"primary",onClick:J,loading:E.value,class:"refresh-btn"},{default:a(()=>[e(_,null,{default:a(()=>[e(f(ie))]),_:1}),t[9]||(t[9]=l("span",{class:"btn-text"},"刷新",-1))]),_:1,__:[9]},8,["loading"])]),_:1})]),_:1})]),l("div",Me,[e(B,{gutter:16,class:"stats-row"},{default:a(()=>[e(c,{xs:24,sm:8,md:8,lg:8,xl:8},{default:a(()=>[l("div",Ue,[l("div",Ye,[e(_,null,{default:a(()=>[e(f(L))]),_:1})]),l("div",$e,[l("div",Te,"¥"+d(A.value),1),t[10]||(t[10]=l("div",{class:"stat-label"},"总充值金额",-1))])])]),_:1}),e(c,{xs:24,sm:8,md:8,lg:8,xl:8},{default:a(()=>[l("div",Ne,[l("div",Be,[e(_,null,{default:a(()=>[e(f(ue))]),_:1})]),l("div",Le,[l("div",Oe,d(I.value),1),t[11]||(t[11]=l("div",{class:"stat-label"},"充值次数",-1))])])]),_:1}),e(c,{xs:24,sm:8,md:8,lg:8,xl:8},{default:a(()=>[l("div",Ae,[l("div",Ie,[e(_,null,{default:a(()=>[e(f(ce))]),_:1})]),l("div",Fe,[l("div",je,d(F.value),1),t[12]||(t[12]=l("div",{class:"stat-label"},"待支付订单",-1))])])]),_:1})]),_:1})]),l("div",qe,[_e((p(),v(X,{data:k.value,style:{width:"100%"},"empty-text":"暂无充值记录"},{default:a(()=>[e(C,{prop:"my_order_number",label:"订单号",width:"200"},{default:a(({row:s})=>[l("div",Je,[u(d(s.my_order_number)+" ",1),e(w,{link:"",size:"small",onClick:te=>$(s.my_order_number),class:"copy-btn"},{default:a(()=>[e(_,null,{default:a(()=>[e(f(O))]),_:1})]),_:2},1032,["onClick"])])]),_:1}),e(C,{prop:"amount",label:"充值金额",width:"120",sortable:""},{default:a(({row:s})=>[l("span",Qe,"¥"+d(s.amount),1)]),_:1}),e(C,{prop:"type",label:"支付方式",width:"100"},{default:a(({row:s})=>[s.type==="支付宝"?(p(),v(m,{key:0,type:"success"},{default:a(()=>[e(_,null,{default:a(()=>[e(f(L))]),_:1}),t[13]||(t[13]=u(" 支付宝 "))]),_:1,__:[13]})):s.type==="微信"?(p(),v(m,{key:1,type:"primary"},{default:a(()=>[e(_,null,{default:a(()=>[e(f(pe))]),_:1}),t[14]||(t[14]=u(" 微信 "))]),_:1,__:[14]})):(p(),v(m,{key:2,type:"info"},{default:a(()=>[u(d(s.type),1)]),_:2},1024))]),_:1}),e(C,{label:"支付状态",width:"120"},{default:a(({row:s})=>[e(m,{type:s.api_order_number?"success":"warning",icon:s.api_order_number?"CircleCheck":"Clock"},{default:a(()=>[u(d(s.api_order_number?"已支付":"待支付"),1)]),_:2},1032,["type","icon"])]),_:1}),e(C,{prop:"time",label:"创建时间",width:"180",sortable:""},{default:a(({row:s})=>[l("div",We,[l("div",null,d(T(s.time)),1),l("div",Xe,d(W(s.time)),1)])]),_:1}),e(C,{label:"操作",width:"80",fixed:"right"},{default:a(({row:s})=>[l("div",Ze,[e(w,{type:"info",size:"small",onClick:te=>Q(s)},{default:a(()=>t[15]||(t[15]=[u(" 详情 ")])),_:2,__:[15]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[ee,E.value]])]),r.total>0?(p(),U("div",Ge,[e(Z,{"current-page":r.currentPage,"onUpdate:currentPage":t[3]||(t[3]=s=>r.currentPage=s),"page-size":r.pageSize,"onUpdate:pageSize":t[4]||(t[4]=s=>r.pageSize=s),"page-sizes":[5,10,20,50],total:r.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:q,onCurrentChange:j},null,8,["current-page","page-size","total"])])):Y("",!0)])]),_:1}),e(K,{modelValue:D.value,"onUpdate:modelValue":t[7]||(t[7]=s=>D.value=s),title:"订单详情",width:"500px"},{footer:a(()=>[l("div",tt,[e(w,{onClick:t[6]||(t[6]=s=>D.value=!1)},{default:a(()=>t[18]||(t[18]=[u("关闭")])),_:1,__:[18]})])]),default:a(()=>[i.value?(p(),U("div",He,[e(H,{column:1,border:""},{default:a(()=>[e(x,{label:"订单号"},{default:a(()=>[l("span",Ke,d(i.value.my_order_number),1),e(w,{link:"",size:"small",onClick:t[5]||(t[5]=s=>$(i.value.my_order_number))},{default:a(()=>[e(_,null,{default:a(()=>[e(f(O))]),_:1})]),_:1})]),_:1}),e(x,{label:"充值金额"},{default:a(()=>[l("span",et,"¥"+d(i.value.amount),1)]),_:1}),e(x,{label:"支付方式"},{default:a(()=>[i.value.type==="支付宝"?(p(),v(m,{key:0,type:"success"},{default:a(()=>t[16]||(t[16]=[u("支付宝")])),_:1,__:[16]})):i.value.type==="微信"?(p(),v(m,{key:1,type:"primary"},{default:a(()=>t[17]||(t[17]=[u("微信")])),_:1,__:[17]})):(p(),v(m,{key:2,type:"info"},{default:a(()=>[u(d(i.value.type),1)]),_:1}))]),_:1}),e(x,{label:"支付状态"},{default:a(()=>[e(m,{type:i.value.api_order_number?"success":"warning"},{default:a(()=>[u(d(i.value.api_order_number?"已支付":"待支付"),1)]),_:1},8,["type"])]),_:1}),e(x,{label:"创建时间"},{default:a(()=>[u(d(T(i.value.time)),1)]),_:1}),i.value.api_order_number?(p(),v(x,{key:0,label:"第三方订单号"},{default:a(()=>[u(d(i.value.api_order_number),1)]),_:1})):Y("",!0)]),_:1})])):Y("",!0)]),_:1},8,["modelValue"])])}}},yt=ae(at,[["__scopeId","data-v-a85c5bd2"]]);export{yt as default};
