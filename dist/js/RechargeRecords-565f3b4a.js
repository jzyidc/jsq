import{_ as ae}from"./_plugin-vue_export-helper-e4601500.js";/* empty css                  *//* empty css                   *//* empty css                       *//* empty css                *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css               */import{u as le,r as g,a0 as oe,$ as M,o as se,b as ne,c as p,d as U,i as e,w as a,E as P,ap as re,as as de,g as o,j as f,b0 as ue,l as u,aJ as L,B as d,aK as ie,b1 as ce,at as _e,k as v,b2 as O,S as pe,f as Y,au as me,av as fe,ao as ve,b3 as ge,p as ye,q as be,an as he,aw as Ce,t as we,ax as ke,ay as Ee,b4 as xe,b5 as De,aB as ze}from"./index-53bb2135.js";import{b as Re}from"./finance-96de9528.js";const Ve={class:"records-container"},Pe={class:"records-content"},Se={class:"filter-section"},Me={class:"stats-section"},Ue={class:"stat-card"},Ye={class:"stat-icon success"},$e={class:"stat-content"},Be={class:"stat-value"},Te={class:"stat-card"},Ne={class:"stat-icon primary"},Le={class:"stat-content"},Oe={class:"stat-value"},Ae={class:"stat-card"},Fe={class:"stat-icon warning"},Ie={class:"stat-content"},je={class:"stat-value"},qe={class:"table-section"},Je={class:"order-number"},Ke={class:"amount"},Ge={class:"time-info"},He={class:"time-ago"},Qe={class:"action-buttons"},We={key:0,class:"pagination-container"},Xe={key:0,class:"order-detail"},Ze={class:"order-number"},et={class:"amount"},tt={class:"dialog-footer"},at={__name:"RechargeRecords",setup(lt){le();const x=g(!1),k=g([]),D=g(!1),i=g(null),z=g(""),R=g(""),y=g([]),r=oe({currentPage:1,pageSize:10,total:0,pageCount:0}),A=M(()=>k.value.filter(s=>s.api_order_number).reduce((s,t)=>s+parseFloat(t.amount||0),0).toFixed(2)),F=M(()=>k.value.length),I=M(()=>k.value.filter(s=>!s.api_order_number).length),b=async(s=1)=>{x.value=!0;try{const t={page:s,pageSize:r.pageSize};z.value&&(t.status=z.value),R.value&&(t.type=R.value),y.value&&y.value.length===2&&(t.startDate=y.value[0],t.endDate=y.value[1]);const n=await Re(t);n.Code===1e3?(k.value=n.List||[],r.currentPage=n.NowPage||s,r.total=n.RowCount||0,r.pageCount=n.PageCount||0):P.error(n.Message||"加载充值记录失败")}catch(t){console.error("加载充值记录失败:",t),P.error("加载充值记录失败，请稍后重试")}finally{x.value=!1}},j=s=>{b(s)},q=s=>{r.pageSize=s,r.currentPage=1,b(1)},S=()=>{r.currentPage=1,b(1)},J=()=>{b(r.currentPage)},K=s=>{i.value=s,D.value=!0},$=async s=>{try{await navigator.clipboard.writeText(s),P.success("订单号已复制到剪贴板")}catch{const n=document.createElement("textarea");n.value=s,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),P.success("订单号已复制到剪贴板")}},B=s=>s?new Date(s).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-",G=s=>{if(!s)return"";const t=new Date,n=new Date(s),h=t-n,c=Math.floor(h/(1e3*60)),V=Math.floor(h/(1e3*60*60)),_=Math.floor(h/(1e3*60*60*24));return c<1?"刚刚":c<60?`${c}分钟前`:V<24?`${V}小时前`:_<30?`${_}天前`:"很久以前"},T=()=>{b(r.currentPage)};return se(()=>{b(),window.addEventListener("recharge-success",T)}),ne(()=>{window.removeEventListener("recharge-success",T)}),(s,t)=>{const n=me,h=fe,c=ve,V=ge,_=ye,E=be,N=he,C=Ce,m=we,H=ke,Q=Ee,W=re,w=xe,X=De,Z=de,ee=ze;return p(),U("div",Ve,[e(W,{class:"records-card"},{header:a(()=>t[8]||(t[8]=[o("div",{class:"card-header"},[o("h3",null,"充值记录"),o("p",null,"查看您的所有充值记录和支付状态")],-1)])),default:a(()=>[o("div",Pe,[o("div",Se,[e(N,{gutter:16},{default:a(()=>[e(c,{span:6},{default:a(()=>[e(h,{modelValue:z.value,"onUpdate:modelValue":t[0]||(t[0]=l=>z.value=l),placeholder:"支付状态",clearable:"",onChange:S},{default:a(()=>[e(n,{label:"全部",value:""}),e(n,{label:"已支付",value:"paid"}),e(n,{label:"待支付",value:"pending"})]),_:1},8,["modelValue"])]),_:1}),e(c,{span:6},{default:a(()=>[e(h,{modelValue:R.value,"onUpdate:modelValue":t[1]||(t[1]=l=>R.value=l),placeholder:"支付方式",clearable:"",onChange:S},{default:a(()=>[e(n,{label:"全部",value:""}),e(n,{label:"支付宝",value:"支付宝"}),e(n,{label:"微信",value:"微信"})]),_:1},8,["modelValue"])]),_:1}),e(c,{span:8},{default:a(()=>[e(V,{modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=l=>y.value=l),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:S},null,8,["modelValue"])]),_:1}),e(c,{span:4},{default:a(()=>[e(E,{type:"primary",onClick:J,loading:x.value},{default:a(()=>[e(_,null,{default:a(()=>[e(f(ue))]),_:1}),t[9]||(t[9]=u(" 刷新 "))]),_:1,__:[9]},8,["loading"])]),_:1})]),_:1})]),o("div",Me,[e(N,{gutter:16},{default:a(()=>[e(c,{span:8},{default:a(()=>[o("div",Ue,[o("div",Ye,[e(_,null,{default:a(()=>[e(f(L))]),_:1})]),o("div",$e,[o("div",Be,"¥"+d(A.value),1),t[10]||(t[10]=o("div",{class:"stat-label"},"总充值金额",-1))])])]),_:1}),e(c,{span:8},{default:a(()=>[o("div",Te,[o("div",Ne,[e(_,null,{default:a(()=>[e(f(ie))]),_:1})]),o("div",Le,[o("div",Oe,d(F.value),1),t[11]||(t[11]=o("div",{class:"stat-label"},"充值次数",-1))])])]),_:1}),e(c,{span:8},{default:a(()=>[o("div",Ae,[o("div",Fe,[e(_,null,{default:a(()=>[e(f(ce))]),_:1})]),o("div",Ie,[o("div",je,d(I.value),1),t[12]||(t[12]=o("div",{class:"stat-label"},"待支付订单",-1))])])]),_:1})]),_:1})]),o("div",qe,[_e((p(),v(H,{data:k.value,style:{width:"100%"},"empty-text":"暂无充值记录"},{default:a(()=>[e(C,{prop:"my_order_number",label:"订单号",width:"200"},{default:a(({row:l})=>[o("div",Je,[u(d(l.my_order_number)+" ",1),e(E,{type:"text",size:"small",onClick:te=>$(l.my_order_number),class:"copy-btn"},{default:a(()=>[e(_,null,{default:a(()=>[e(f(O))]),_:1})]),_:2},1032,["onClick"])])]),_:1}),e(C,{prop:"amount",label:"充值金额",width:"120",sortable:""},{default:a(({row:l})=>[o("span",Ke,"¥"+d(l.amount),1)]),_:1}),e(C,{prop:"type",label:"支付方式",width:"100"},{default:a(({row:l})=>[l.type==="支付宝"?(p(),v(m,{key:0,type:"success"},{default:a(()=>[e(_,null,{default:a(()=>[e(f(L))]),_:1}),t[13]||(t[13]=u(" 支付宝 "))]),_:1,__:[13]})):l.type==="微信"?(p(),v(m,{key:1,type:"primary"},{default:a(()=>[e(_,null,{default:a(()=>[e(f(pe))]),_:1}),t[14]||(t[14]=u(" 微信 "))]),_:1,__:[14]})):(p(),v(m,{key:2,type:"info"},{default:a(()=>[u(d(l.type),1)]),_:2},1024))]),_:1}),e(C,{label:"支付状态",width:"120"},{default:a(({row:l})=>[e(m,{type:l.api_order_number?"success":"warning",icon:l.api_order_number?"CircleCheck":"Clock"},{default:a(()=>[u(d(l.api_order_number?"已支付":"待支付"),1)]),_:2},1032,["type","icon"])]),_:1}),e(C,{prop:"time",label:"创建时间",width:"180",sortable:""},{default:a(({row:l})=>[o("div",Ge,[o("div",null,d(B(l.time)),1),o("div",He,d(G(l.time)),1)])]),_:1}),e(C,{label:"操作",width:"80",fixed:"right"},{default:a(({row:l})=>[o("div",Qe,[e(E,{type:"info",size:"small",onClick:te=>K(l)},{default:a(()=>t[15]||(t[15]=[u(" 详情 ")])),_:2,__:[15]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[ee,x.value]])]),r.total>0?(p(),U("div",We,[e(Q,{"current-page":r.currentPage,"onUpdate:currentPage":t[3]||(t[3]=l=>r.currentPage=l),"page-size":r.pageSize,"onUpdate:pageSize":t[4]||(t[4]=l=>r.pageSize=l),"page-sizes":[5,10,20,50],total:r.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:q,onCurrentChange:j},null,8,["current-page","page-size","total"])])):Y("",!0)])]),_:1}),e(Z,{modelValue:D.value,"onUpdate:modelValue":t[7]||(t[7]=l=>D.value=l),title:"订单详情",width:"500px"},{footer:a(()=>[o("div",tt,[e(E,{onClick:t[6]||(t[6]=l=>D.value=!1)},{default:a(()=>t[18]||(t[18]=[u("关闭")])),_:1,__:[18]})])]),default:a(()=>[i.value?(p(),U("div",Xe,[e(X,{column:1,border:""},{default:a(()=>[e(w,{label:"订单号"},{default:a(()=>[o("span",Ze,d(i.value.my_order_number),1),e(E,{type:"text",size:"small",onClick:t[5]||(t[5]=l=>$(i.value.my_order_number))},{default:a(()=>[e(_,null,{default:a(()=>[e(f(O))]),_:1})]),_:1})]),_:1}),e(w,{label:"充值金额"},{default:a(()=>[o("span",et,"¥"+d(i.value.amount),1)]),_:1}),e(w,{label:"支付方式"},{default:a(()=>[i.value.type==="支付宝"?(p(),v(m,{key:0,type:"success"},{default:a(()=>t[16]||(t[16]=[u("支付宝")])),_:1,__:[16]})):i.value.type==="微信"?(p(),v(m,{key:1,type:"primary"},{default:a(()=>t[17]||(t[17]=[u("微信")])),_:1,__:[17]})):(p(),v(m,{key:2,type:"info"},{default:a(()=>[u(d(i.value.type),1)]),_:1}))]),_:1}),e(w,{label:"支付状态"},{default:a(()=>[e(m,{type:i.value.api_order_number?"success":"warning"},{default:a(()=>[u(d(i.value.api_order_number?"已支付":"待支付"),1)]),_:1},8,["type"])]),_:1}),e(w,{label:"创建时间"},{default:a(()=>[u(d(B(i.value.time)),1)]),_:1}),i.value.api_order_number?(p(),v(w,{key:0,label:"第三方订单号"},{default:a(()=>[u(d(i.value.api_order_number),1)]),_:1})):Y("",!0)]),_:1})])):Y("",!0)]),_:1},8,["modelValue"])])}}},yt=ae(at,[["__scopeId","data-v-3af5b2f6"]]);export{yt as default};
