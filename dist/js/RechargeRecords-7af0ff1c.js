import{_ as ae}from"./_plugin-vue_export-helper-e4601500.js";/* empty css                  *//* empty css                   *//* empty css                             *//* empty css                *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css               *//* empty css                       */import{u as le,r as g,$ as se,a9 as M,o as oe,b as ne,c as p,d as U,i as e,w as a,E as P,aG as re,aA as de,g as l,j as f,aN as ie,ag as B,D as d,ah as ue,aO as ce,aP as _e,k as v,l as u,aQ as L,S as pe,f as Y,aR as me,aS as fe,aH as ve,aT as ge,p as ye,q as be,az as he,aU as Ce,t as xe,aV as we,aW as ke,aX as Ee,aY as De,aZ as ze}from"./index-cf8bdcfb.js";import{b as Re}from"./finance-f416d1f2.js";const Ve={class:"records-container"},Pe={class:"records-content"},Se={class:"filter-section"},Me={class:"stats-section"},Ue={class:"stat-card"},Ye={class:"stat-icon success"},Te={class:"stat-content"},$e={class:"stat-value"},Ne={class:"stat-card"},Oe={class:"stat-icon primary"},Be={class:"stat-content"},Le={class:"stat-value"},Ae={class:"stat-card"},Fe={class:"stat-icon warning"},Ie={class:"stat-content"},je={class:"stat-value"},qe={class:"table-section"},Ge={class:"order-number"},He={class:"amount"},Qe={class:"time-info"},We={class:"time-ago"},Xe={class:"action-buttons"},Ze={key:0,class:"pagination-container"},Je={key:0,class:"order-detail"},Ke={class:"order-number"},et={class:"amount"},tt={class:"dialog-footer"},at={__name:"RechargeRecords",setup(lt){le();const E=g(!1),w=g([]),D=g(!1),i=g(null),z=g(""),R=g(""),y=g([]),r=se({currentPage:1,pageSize:10,total:0,pageCount:0}),A=M(()=>w.value.filter(o=>o.api_order_number).reduce((o,t)=>o+parseFloat(t.amount||0),0).toFixed(2)),F=M(()=>w.value.length),I=M(()=>w.value.filter(o=>!o.api_order_number).length),b=async(o=1)=>{E.value=!0;try{const t={page:o,pageSize:r.pageSize};z.value&&(t.status=z.value),R.value&&(t.type=R.value),y.value&&y.value.length===2&&(t.startDate=y.value[0],t.endDate=y.value[1]);const n=await Re(t);n.Code===1e3?(w.value=n.List||[],r.currentPage=n.NowPage||o,r.total=n.RowCount||0,r.pageCount=n.PageCount||0):P.error(n.Message||"加载充值记录失败")}catch(t){console.error("加载充值记录失败:",t),P.error("加载充值记录失败，请稍后重试")}finally{E.value=!1}},j=o=>{b(o)},q=o=>{r.pageSize=o,r.currentPage=1,b(1)},S=()=>{r.currentPage=1,b(1)},G=()=>{b(r.currentPage)},H=o=>{i.value=o,D.value=!0},T=async o=>{try{await navigator.clipboard.writeText(o),P.success("订单号已复制到剪贴板")}catch{const n=document.createElement("textarea");n.value=o,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),P.success("订单号已复制到剪贴板")}},$=o=>o?new Date(o).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-",Q=o=>{if(!o)return"";const t=new Date,n=new Date(o),h=t-n,c=Math.floor(h/(1e3*60)),V=Math.floor(h/(1e3*60*60)),_=Math.floor(h/(1e3*60*60*24));return c<1?"刚刚":c<60?`${c}分钟前`:V<24?`${V}小时前`:_<30?`${_}天前`:"很久以前"},N=()=>{b(r.currentPage)};return oe(()=>{b(),window.addEventListener("recharge-success",N)}),ne(()=>{window.removeEventListener("recharge-success",N)}),(o,t)=>{const n=me,h=fe,c=ve,V=ge,_=ye,k=be,O=he,C=Ce,m=xe,W=we,X=ke,Z=re,x=Ee,J=De,K=de,ee=ze;return p(),U("div",Ve,[e(Z,{class:"records-card"},{header:a(()=>t[8]||(t[8]=[l("div",{class:"card-header"},[l("h3",null,"充值记录"),l("p",null,"查看您的所有充值记录和支付状态")],-1)])),default:a(()=>[l("div",Pe,[l("div",Se,[e(O,{gutter:16,class:"filter-row"},{default:a(()=>[e(c,{xs:24,sm:12,md:6,lg:6,xl:6},{default:a(()=>[e(h,{modelValue:z.value,"onUpdate:modelValue":t[0]||(t[0]=s=>z.value=s),placeholder:"支付状态",clearable:"",onChange:S},{default:a(()=>[e(n,{label:"全部",value:""}),e(n,{label:"已支付",value:"paid"}),e(n,{label:"待支付",value:"pending"})]),_:1},8,["modelValue"])]),_:1}),e(c,{xs:24,sm:12,md:6,lg:6,xl:6},{default:a(()=>[e(h,{modelValue:R.value,"onUpdate:modelValue":t[1]||(t[1]=s=>R.value=s),placeholder:"支付方式",clearable:"",onChange:S},{default:a(()=>[e(n,{label:"全部",value:""}),e(n,{label:"支付宝",value:"支付宝"}),e(n,{label:"微信",value:"微信"})]),_:1},8,["modelValue"])]),_:1}),e(c,{xs:24,sm:16,md:8,lg:8,xl:8},{default:a(()=>[e(V,{modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=s=>y.value=s),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:S,class:"mobile-date-picker"},null,8,["modelValue"])]),_:1}),e(c,{xs:24,sm:8,md:4,lg:4,xl:4},{default:a(()=>[e(k,{type:"primary",onClick:G,loading:E.value,class:"refresh-btn"},{default:a(()=>[e(_,null,{default:a(()=>[e(f(ie))]),_:1}),t[9]||(t[9]=l("span",{class:"btn-text"},"刷新",-1))]),_:1,__:[9]},8,["loading"])]),_:1})]),_:1})]),l("div",Me,[e(O,{gutter:16,class:"stats-row"},{default:a(()=>[e(c,{xs:24,sm:8,md:8,lg:8,xl:8},{default:a(()=>[l("div",Ue,[l("div",Ye,[e(_,null,{default:a(()=>[e(f(B))]),_:1})]),l("div",Te,[l("div",$e,"¥"+d(A.value),1),t[10]||(t[10]=l("div",{class:"stat-label"},"总充值金额",-1))])])]),_:1}),e(c,{xs:24,sm:8,md:8,lg:8,xl:8},{default:a(()=>[l("div",Ne,[l("div",Oe,[e(_,null,{default:a(()=>[e(f(ue))]),_:1})]),l("div",Be,[l("div",Le,d(F.value),1),t[11]||(t[11]=l("div",{class:"stat-label"},"充值次数",-1))])])]),_:1}),e(c,{xs:24,sm:8,md:8,lg:8,xl:8},{default:a(()=>[l("div",Ae,[l("div",Fe,[e(_,null,{default:a(()=>[e(f(ce))]),_:1})]),l("div",Ie,[l("div",je,d(I.value),1),t[12]||(t[12]=l("div",{class:"stat-label"},"待支付订单",-1))])])]),_:1})]),_:1})]),l("div",qe,[_e((p(),v(W,{data:w.value,style:{width:"100%"},"empty-text":"暂无充值记录"},{default:a(()=>[e(C,{prop:"my_order_number",label:"订单号",width:"200"},{default:a(({row:s})=>[l("div",Ge,[u(d(s.my_order_number)+" ",1),e(k,{type:"text",size:"small",onClick:te=>T(s.my_order_number),class:"copy-btn"},{default:a(()=>[e(_,null,{default:a(()=>[e(f(L))]),_:1})]),_:2},1032,["onClick"])])]),_:1}),e(C,{prop:"amount",label:"充值金额",width:"120",sortable:""},{default:a(({row:s})=>[l("span",He,"¥"+d(s.amount),1)]),_:1}),e(C,{prop:"type",label:"支付方式",width:"100"},{default:a(({row:s})=>[s.type==="支付宝"?(p(),v(m,{key:0,type:"success"},{default:a(()=>[e(_,null,{default:a(()=>[e(f(B))]),_:1}),t[13]||(t[13]=u(" 支付宝 "))]),_:1,__:[13]})):s.type==="微信"?(p(),v(m,{key:1,type:"primary"},{default:a(()=>[e(_,null,{default:a(()=>[e(f(pe))]),_:1}),t[14]||(t[14]=u(" 微信 "))]),_:1,__:[14]})):(p(),v(m,{key:2,type:"info"},{default:a(()=>[u(d(s.type),1)]),_:2},1024))]),_:1}),e(C,{label:"支付状态",width:"120"},{default:a(({row:s})=>[e(m,{type:s.api_order_number?"success":"warning",icon:s.api_order_number?"CircleCheck":"Clock"},{default:a(()=>[u(d(s.api_order_number?"已支付":"待支付"),1)]),_:2},1032,["type","icon"])]),_:1}),e(C,{prop:"time",label:"创建时间",width:"180",sortable:""},{default:a(({row:s})=>[l("div",Qe,[l("div",null,d($(s.time)),1),l("div",We,d(Q(s.time)),1)])]),_:1}),e(C,{label:"操作",width:"80",fixed:"right"},{default:a(({row:s})=>[l("div",Xe,[e(k,{type:"info",size:"small",onClick:te=>H(s)},{default:a(()=>t[15]||(t[15]=[u(" 详情 ")])),_:2,__:[15]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[ee,E.value]])]),r.total>0?(p(),U("div",Ze,[e(X,{"current-page":r.currentPage,"onUpdate:currentPage":t[3]||(t[3]=s=>r.currentPage=s),"page-size":r.pageSize,"onUpdate:pageSize":t[4]||(t[4]=s=>r.pageSize=s),"page-sizes":[5,10,20,50],total:r.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:q,onCurrentChange:j},null,8,["current-page","page-size","total"])])):Y("",!0)])]),_:1}),e(K,{modelValue:D.value,"onUpdate:modelValue":t[7]||(t[7]=s=>D.value=s),title:"订单详情",width:"500px"},{footer:a(()=>[l("div",tt,[e(k,{onClick:t[6]||(t[6]=s=>D.value=!1)},{default:a(()=>t[18]||(t[18]=[u("关闭")])),_:1,__:[18]})])]),default:a(()=>[i.value?(p(),U("div",Je,[e(J,{column:1,border:""},{default:a(()=>[e(x,{label:"订单号"},{default:a(()=>[l("span",Ke,d(i.value.my_order_number),1),e(k,{type:"text",size:"small",onClick:t[5]||(t[5]=s=>T(i.value.my_order_number))},{default:a(()=>[e(_,null,{default:a(()=>[e(f(L))]),_:1})]),_:1})]),_:1}),e(x,{label:"充值金额"},{default:a(()=>[l("span",et,"¥"+d(i.value.amount),1)]),_:1}),e(x,{label:"支付方式"},{default:a(()=>[i.value.type==="支付宝"?(p(),v(m,{key:0,type:"success"},{default:a(()=>t[16]||(t[16]=[u("支付宝")])),_:1,__:[16]})):i.value.type==="微信"?(p(),v(m,{key:1,type:"primary"},{default:a(()=>t[17]||(t[17]=[u("微信")])),_:1,__:[17]})):(p(),v(m,{key:2,type:"info"},{default:a(()=>[u(d(i.value.type),1)]),_:1}))]),_:1}),e(x,{label:"支付状态"},{default:a(()=>[e(m,{type:i.value.api_order_number?"success":"warning"},{default:a(()=>[u(d(i.value.api_order_number?"已支付":"待支付"),1)]),_:1},8,["type"])]),_:1}),e(x,{label:"创建时间"},{default:a(()=>[u(d($(i.value.time)),1)]),_:1}),i.value.api_order_number?(p(),v(x,{key:0,label:"第三方订单号"},{default:a(()=>[u(d(i.value.api_order_number),1)]),_:1})):Y("",!0)]),_:1})])):Y("",!0)]),_:1},8,["modelValue"])])}}},bt=ae(at,[["__scopeId","data-v-dfc51de6"]]);export{bt as default};
