import{_ as ze}from"./_plugin-vue_export-helper-e4601500.js";/* empty css                  *//* empty css                *//* empty css                 *//* empty css               *//* empty css                     *//* empty css                        *//* empty css                       *//* empty css                   *//* empty css               *//* empty css                */import{r as v,a as Oe,u as He,b9 as Qe,$ as B,aa as de,o as We,b as je,c as d,d as _,g as a,i as s,w as o,l as I,B as r,at as Ke,k as z,f as N,m as X,ba as Je,E as p,bb as Xe,p as Ye,ap as Ze,aB as ea,j as c,O as ce,bc as ve,F as x,h as E,bd as aa,aQ as _e,be as pe,R as fe,aW as sa,H as ta,bf as me,P as la,x as ge,N as na,aI as oa,aJ as ia,bg as ua,am as ra,q as da,au as ca,av as va,ao as _a,an as pa,a_ as fa,bh as ma,aA as ga,aF as ya,t as ha,ay as ba,a3 as ka,a6 as Ca}from"./index-53bb2135.js";const wa={class:"routes-page"},Ia={class:"page-header"},Va={class:"header-content"},Ta={class:"title-section"},Pa={class:"page-title"},xa={class:"stats-info"},Ea={class:"stat-item"},Ma={class:"stat-number"},qa={class:"stat-item"},Ba={class:"stat-number"},Na={class:"main-content"},La={class:"content-layout"},Sa={class:"left-sidebar"},Ua={class:"card-header"},$a={class:"region-buttons-vertical"},Da={class:"region-btn-content"},Ga={class:"region-name"},Aa={class:"region-count"},Ra={class:"right-content"},Fa={class:"card-header"},za={class:"filter-section"},Oa={class:"filter-item"},Ha={class:"filter-item"},Qa={class:"filter-item"},Wa={class:"filter-section"},ja={class:"filter-item"},Ka={class:"filter-item"},Ja={class:"card-header"},Xa={class:"assign-content"},Ya={class:"assign-input"},Za={class:"assign-tip"},es={class:"card-header"},as={class:"header-actions"},ss={class:"page-info"},ts={class:"node-grid"},ls={class:"node-header"},ns={class:"node-name"},os={class:"node-status"},is={class:"node-details"},us={key:0,class:"detail-item"},rs={key:1,class:"detail-item"},ds={class:"detail-item"},cs={key:2,class:"detail-item"},vs={key:3,class:"detail-item"},_s={class:"node-footer"},ps={class:"node-price"},fs={class:"price-label"},ms={class:"price-value"},gs={key:0,class:"pagination-wrapper"},ys={key:0,class:"icon-badge"},hs={class:"summary-header"},bs={class:"summary-content"},ks={class:"summary-item"},Cs={class:"item-value"},ws={class:"summary-item"},Is={class:"item-value"},Vs={class:"summary-item assign-group-item"},Ts={class:"order-list"},Ps={key:0,class:"empty-order"},xs={key:1,class:"order-items"},Es={class:"order-info"},Ms={class:"order-name"},qs={class:"quantity-control"},Bs={class:"order-actions"},Ns={class:"order-price"},Ls={class:"summary-total"},Ss={class:"total-item"},Us={class:"total-value"},$s={class:"total-item price-total"},Ds={class:"total-price"},Gs={class:"balance-info"},As={class:"balance-value"},Rs={__name:"Routes",setup(Fs){v([]);const D=v([]),ye=["一天","一周","一个月","三个月","半年","一年"],he=["全部","移动","电信","多线"],G=v(["全部"]),Y=["全部","福建","四川","广东","河北","江苏","陕西","湖南","甘肃","海南","山西","云南","青海","吉林","广西","黑龙江","宁夏","西藏","辽宁","安徽","直辖市","山东","河南","贵州","浙江","内蒙古","江西","湖北"],O=v(""),m=v(""),k=v("一个月"),b=v("全部"),h=v("全部");v("中国");const C=v("全部"),H=v(10),V=v(!1),T=v("0000"),Z=Oe(),A=He(),g=v(null),M=v(!1),L=()=>{g.value&&clearTimeout(g.value),g.value=setTimeout(()=>{!M.value&&i.value.length===0&&(V.value=!0)},5e3)},be=()=>{M.value=!0,g.value&&clearTimeout(g.value)},ke=()=>{M.value=!1,i.value.length===0&&L()},w=Qe([]),q=v(1),R=v(20),Q=v(!1),F=v(new Map);let S=null;const Ce=(l,e,n)=>`${l}_${e||"all"}_${n||"all"}`,U=B(()=>w.value.filter(l=>{const e=b.value==="全部"||l.operator===b.value;let n=C.value==="全部";!n&&C.value&&l.region&&(n=l.region.includes(C.value)||C.value.includes(l.region));const f=h.value==="全部"||l.type===h.value;return e&&n&&f})),ee=B(()=>{const l=(q.value-1)*R.value,e=l+R.value;return U.value.slice(l,e)}),ae=B(()=>Math.ceil(U.value.length/R.value)),we=B(()=>{const l={};return Y.forEach(e=>{e==="全部"?l[e]=w.value.length:l[e]=w.value.filter(n=>n.region&&(n.region.includes(e)||e.includes(n.region))).length}),l}),i=v([]),Ie=l=>{if(i.value.find(e=>e.id===l.id))p.warning("该节点已在订单中");else{const e={...l,quantity:1};i.value.push(e),p.success(`已添加 ${l.name} 到订单`),V.value=!1,g.value&&clearTimeout(g.value)}},Ve=l=>{const e=i.value.findIndex(n=>n.id===l.id);e>-1&&(i.value.splice(e,1),p.info(`已从订单中移除 ${l.name}`),i.value.length===0&&!M.value&&L())},W=(l,e)=>{if(!l.priceInfo)return l.price;switch(e){case"一天":return l.priceInfo.day;case"一周":return l.priceInfo.week;case"一个月":return l.priceInfo.month;case"三个月":return l.priceInfo.threeMonth;case"半年":return l.priceInfo.sixMonth;case"一年":return l.priceInfo.year;default:return l.priceInfo.month}},Te=l=>{switch(l){case"一天":return"日付价格";case"一周":return"周付价格";case"一个月":return"月付价格";case"三个月":return"季付价格";case"半年":return"半年价格";case"一年":return"年付价格";default:return"月付价格"}},se=B(()=>i.value.reduce((l,e)=>l+W(e,k.value)*(e.quantity||1),0)),Pe=B(()=>i.value.reduce((l,e)=>l+(e.quantity||1),0)),xe=l=>{l.quantity<1?l.quantity=1:l.quantity>20&&(l.quantity=20),p.info(`已更新 ${l.name} 的数量为 ${l.quantity}`)},Ee=()=>{const l=U.value.filter(e=>{if(e.stock==="99+")return!0;const n=parseInt(e.stock);return!isNaN(n)&&n>0}).sort((e,n)=>{const f=e.stock==="99+"?999:parseInt(e.stock)||0;return(n.stock==="99+"?999:parseInt(n.stock)||0)-f}).slice(0,H.value).map(e=>({...e,quantity:1}));i.value=l,p.success(`已智能分配 ${l.length} 个节点（按库存量优先）`),V.value=!1,g.value&&clearTimeout(g.value)},Me=async()=>{if(i.value.length===0){p.warning("请先选择要购买的节点");return}if(!m.value){p.warning("请先选择购买项目");return}if(A.userInfo.balance<se.value){p.warning("账户余额不足，请先充值");return}try{p.info("正在处理支付请求...");const l=i.value.map(n=>({area:n.name,quantity:n.quantity.toString()})),e=await ua({BuyGame:m.value,BuyTime:k.value,BuyInfo:l,AssignGroup:T.value});if(e.Code===1e3){const n=e.OrderNumber?`支付成功！订单号：${e.OrderNumber}`:"支付成功！节点已添加到您的账户";p.success(n),e.Balance!==void 0?A.updateUserInfo({balance:e.Balance}):await A.getUserInfoAction(),i.value=[],M.value||L(),setTimeout(()=>{Z.push("/user/business/list")},1500)}else p.error(e.Msg||"支付失败，请重试")}catch{p.error("支付失败，请检查网络连接后重试")}},qe=()=>{Z.push("/user/recharge")},Be=()=>{i.value=[],p.info("已重置分配，订单已清空"),M.value||L()},Ne=l=>{const e=l.replace(/[^0-9]/g,"");e.length>4?T.value=e.slice(0,4):T.value=e,parseInt(T.value||"0")>9999&&(T.value="9999")},te=()=>{V.value=!V.value,g.value&&clearTimeout(g.value)},le=async(l="")=>{try{const e=await Je(l);e.Code===1e3&&e.List?(D.value=e.List,m.value="",D.value.length>0&&(m.value=D.value[0].Game,j())):p.error("获取游戏数据失败")}catch{p.error("获取游戏数据失败")}},j=async()=>{if(!m.value)return;const l=Ce(m.value,b.value,h.value);if(F.value.has(l)){w.value=F.value.get(l);return}Q.value=!0;try{const e={GameName:m.value};b.value&&b.value!=="全部"&&(e.ScreenIsp=b.value),h.value&&h.value!=="全部"&&(e.ScreenType=h.value);const n=await Xe(e);if(n.Code===1e3)if(n.List&&n.List.length>0){n.ScreenTypeList&&n.ScreenTypeList.length>0&&G.value.length===1&&(G.value=["全部",...n.ScreenTypeList],G.value.includes(h.value)||(h.value="全部"));const f=n.List.map((u,P)=>({id:u.Id||P+1,name:u.Area||"",stock:u.Count>0?u.Count.toString():"99+",price:u.Price_Moon||u.Price||0,operator:u.Isp||"",region:u.Province||"",priceInfo:{day:u.Price_Day||0,week:u.Price_Week||0,month:u.Price_Moon||u.Price||0,threeMonth:u.Price_Three_Moon_Price||0,sixMonth:u.Price_Six_Moon_Price||0,year:u.Price_year_Price||0},type:u.Type||"",effective:u.Effective||"",stability:u.Stability||""}));F.value.set(l,f),w.value=f}else p.warning("暂无可用节点"),w.value=[];else p.error("获取节点数据失败"),w.value=[]}catch{p.error("获取节点数据失败"),w.value=[]}finally{Q.value=!1}},Le=()=>{S&&clearTimeout(S),S=setTimeout(()=>{j()},300)},Se=()=>{F.value.clear(),le(O.value)},Ue=()=>{m.value&&j()},$e=l=>{q.value=l,ra(()=>{const e=document.querySelector(".nodes-card");e&&e.scrollIntoView({behavior:"smooth",block:"start"})})},ne=()=>{q.value=1};return de([m,b,h],()=>{m.value&&(ne(),Le())},{deep:!0}),de(C,()=>{ne()}),We(()=>{le(),i.value.length===0&&L()}),je(()=>{g.value&&clearTimeout(g.value),S&&clearTimeout(S)}),(l,e)=>{const n=Ye,f=da,u=Ze,P=ca,K=va,$=_a,oe=pa,J=fa,ie=ma,ue=ga,re=ya,De=ha,Ge=ba,Ae=ka,Re=Ca,Fe=ea;return d(),_("div",wa,[a("div",Ia,[a("div",Va,[a("div",Ta,[a("h1",Pa,[s(n,{class:"title-icon"},{default:o(()=>[s(c(ce))]),_:1}),e[8]||(e[8]=I(" 项目线路购买 "))]),e[9]||(e[9]=a("p",{class:"page-subtitle"},"选择适合您的线路节点，享受稳定高速的网络服务",-1))]),a("div",xa,[a("div",Ea,[a("span",Ma,r(ee.value.length),1),e[10]||(e[10]=a("span",{class:"stat-label"},"可用节点",-1))]),a("div",qa,[a("span",Ba,r(i.value.length),1),e[11]||(e[11]=a("span",{class:"stat-label"},"已选择",-1))])])])]),a("div",Na,[a("div",La,[a("div",Sa,[s(u,{class:"region-card",shadow:"hover"},{header:o(()=>[a("div",Ua,[s(n,null,{default:o(()=>[s(c(ve))]),_:1}),e[12]||(e[12]=a("span",null,"地区选择",-1))])]),default:o(()=>[a("div",$a,[(d(),_(x,null,E(Y,t=>s(f,{key:t,type:C.value===t?"primary":"default",class:X([{"region-active":C.value===t},"region-btn-vertical"]),onClick:y=>C.value=t},{default:o(()=>[a("div",Da,[a("span",Ga,r(t),1),a("span",Aa,"("+r(we.value[t]||0)+")",1)])]),_:2},1032,["type","class","onClick"])),64))])]),_:1})]),a("div",Ra,[s(u,{class:"filter-card",shadow:"hover"},{header:o(()=>[a("div",Fa,[s(n,null,{default:o(()=>[s(c(aa))]),_:1}),e[13]||(e[13]=a("span",null,"筛选条件",-1))])]),default:o(()=>[a("div",za,[s(oe,{gutter:20},{default:o(()=>[s($,{span:8},{default:o(()=>[a("div",Oa,[e[14]||(e[14]=a("label",{class:"filter-label"},"游戏类型",-1)),s(K,{modelValue:O.value,"onUpdate:modelValue":e[0]||(e[0]=t=>O.value=t),class:"filter-select",onChange:Se},{default:o(()=>[s(P,{label:"全部",value:""}),s(P,{label:"端游",value:"1"}),s(P,{label:"手游",value:"2"})]),_:1},8,["modelValue"])])]),_:1}),s($,{span:8},{default:o(()=>[a("div",Ha,[e[15]||(e[15]=a("label",{class:"filter-label"},"购买项目",-1)),s(K,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=t=>m.value=t),class:"filter-select",placeholder:"请选择游戏",onChange:Ue},{default:o(()=>[(d(!0),_(x,null,E(D.value,t=>(d(),z(P,{key:t.Id,label:t.Game,value:t.Game},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1}),s($,{span:8},{default:o(()=>[a("div",Qa,[e[16]||(e[16]=a("label",{class:"filter-label"},"购买时长",-1)),s(K,{modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=t=>k.value=t),class:"filter-select"},{default:o(()=>[(d(),_(x,null,E(ye,t=>s(P,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),s(J,null,{default:o(()=>[s(n,null,{default:o(()=>[s(c(_e))]),_:1}),e[17]||(e[17]=I("高级筛选"))]),_:1,__:[17]}),a("div",Wa,[s(oe,{gutter:20},{default:o(()=>[s($,{span:12},{default:o(()=>[a("div",ja,[e[18]||(e[18]=a("label",{class:"filter-label"},"运营商",-1)),s(ue,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=t=>b.value=t),class:"filter-radio"},{default:o(()=>[(d(),_(x,null,E(he,t=>s(ie,{key:t,label:t},null,8,["label"])),64))]),_:1},8,["modelValue"])])]),_:1}),s($,{span:12},{default:o(()=>[a("div",Ka,[e[19]||(e[19]=a("label",{class:"filter-label"},"线路类型",-1)),s(ue,{modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=t=>h.value=t),class:"filter-radio"},{default:o(()=>[(d(!0),_(x,null,E(G.value,t=>(d(),z(ie,{key:t,label:t},null,8,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1})])]),_:1}),s(u,{class:"assign-card",shadow:"hover"},{header:o(()=>[a("div",Ja,[s(n,null,{default:o(()=>[s(c(_e))]),_:1}),e[20]||(e[20]=a("span",null,"智能分配",-1))])]),default:o(()=>[a("div",Xa,[a("div",Ya,[e[23]||(e[23]=a("label",{class:"assign-label"},"需要购买的节点数量：",-1)),s(re,{modelValue:H.value,"onUpdate:modelValue":e[5]||(e[5]=t=>H.value=t),min:1,max:20,class:"node-counter"},null,8,["modelValue"]),s(f,{type:"primary",onClick:Ee,class:"assign-btn"},{default:o(()=>[s(n,null,{default:o(()=>[s(c(pe))]),_:1}),e[21]||(e[21]=I(" 智能分配 "))]),_:1,__:[21]}),s(f,{type:"warning",onClick:Be,class:"assign-btn",disabled:i.value.length===0},{default:o(()=>[s(n,null,{default:o(()=>[s(c(fe))]),_:1}),e[22]||(e[22]=I(" 重置分配 "))]),_:1,__:[22]},8,["disabled"])]),a("div",Za,[s(n,null,{default:o(()=>[s(c(sa))]),_:1}),e[24]||(e[24]=a("span",null,"系统将根据您的需求自动选择最优的节点组合",-1))])])]),_:1}),Ke((d(),z(u,{class:"nodes-card",shadow:"hover"},{header:o(()=>[a("div",es,[s(n,null,{default:o(()=>[s(c(ta))]),_:1}),a("span",null,"可用节点 ("+r(U.value.length)+")",1),a("div",as,[a("span",ss,"第 "+r(q.value)+" / "+r(ae.value)+" 页",1)])])]),default:o(()=>[a("div",ts,[(d(!0),_(x,null,E(ee.value,t=>(d(),_("div",{key:t.id,class:X(["node-item",{"node-selected":i.value.find(y=>y.id===t.id)}])},[a("div",ls,[a("div",ns,r(t.name),1),a("div",os,[s(De,{type:t.stock==="99+"?"success":"warning",size:"small"},{default:o(()=>[I(r(t.stock==="99+"?"充足":"紧张"),1)]),_:2},1032,["type"])])]),a("div",is,[t.operator?(d(),_("div",us,[s(n,null,{default:o(()=>[s(c(ce))]),_:1}),a("span",null,r(t.operator),1)])):N("",!0),t.region?(d(),_("div",rs,[s(n,null,{default:o(()=>[s(c(ve))]),_:1}),a("span",null,r(t.region),1)])):N("",!0),a("div",ds,[s(n,null,{default:o(()=>[s(c(me))]),_:1}),a("span",null,"剩余: "+r(t.stock),1)]),t.type?(d(),_("div",cs,[s(n,null,{default:o(()=>[s(c(pe))]),_:1}),a("span",null,r(t.type),1)])):N("",!0),t.stability?(d(),_("div",vs,[s(n,null,{default:o(()=>[s(c(la))]),_:1}),a("span",null,r(t.stability),1)])):N("",!0)]),a("div",_s,[a("div",ps,[a("span",fs,r(Te(k.value)),1),a("span",ms,"￥"+r(W(t,k.value)),1)]),s(f,{type:i.value.find(y=>y.id===t.id)?"success":"primary",icon:i.value.find(y=>y.id===t.id)?"Check":"Plus",onClick:y=>Ie(t),class:"add-btn"},{default:o(()=>[I(r(i.value.find(y=>y.id===t.id)?"已添加":"加入订单"),1)]),_:2},1032,["type","icon","onClick"])])],2))),128))]),ae.value>1?(d(),_("div",gs,[s(Ge,{"current-page":q.value,"onUpdate:currentPage":e[6]||(e[6]=t=>q.value=t),"page-size":R.value,total:U.value.length,layout:"prev, pager, next, jumper","hide-on-single-page":!1,small:"",onCurrentChange:$e},null,8,["current-page","page-size","total"])])):N("",!0)]),_:1})),[[Fe,Q.value]])])])]),a("div",{class:X(["order-summary",{"order-summary-hidden":V.value}]),onMouseenter:be,onMouseleave:ke},[V.value?(d(),_("div",{key:0,class:"summary-icon",onClick:te},[s(n,{class:"cart-icon"},{default:o(()=>[s(c(ge))]),_:1}),i.value.length>0?(d(),_("div",ys,r(i.value.length),1)):N("",!0),e[25]||(e[25]=a("div",{class:"icon-tooltip"},"订单汇总",-1))])):(d(),z(u,{key:1,class:"summary-card",shadow:"always"},{header:o(()=>[a("div",hs,[s(n,null,{default:o(()=>[s(c(ge))]),_:1}),e[26]||(e[26]=a("span",null,"订单汇总",-1)),s(f,{type:"text",class:"toggle-btn",onClick:te},{default:o(()=>[s(n,null,{default:o(()=>[s(c(na))]),_:1})]),_:1})])]),default:o(()=>[a("div",bs,[a("div",ks,[e[27]||(e[27]=a("span",{class:"item-label"},"选择项目：",-1)),a("span",Cs,r(m.value),1)]),a("div",ws,[e[28]||(e[28]=a("span",{class:"item-label"},"购买时长：",-1)),a("span",Is,r(k.value),1)]),a("div",Vs,[e[29]||(e[29]=a("span",{class:"item-label"},"分组：",-1)),s(Ae,{modelValue:T.value,"onUpdate:modelValue":e[7]||(e[7]=t=>T.value=t),placeholder:"0000-9999",maxlength:"4",class:"assign-group-input",onInput:Ne},null,8,["modelValue"])]),s(J),a("div",Ts,[e[32]||(e[32]=a("div",{class:"list-header"},"已选线路：",-1)),i.value.length===0?(d(),_("div",Ps,[s(n,null,{default:o(()=>[s(c(me))]),_:1}),e[30]||(e[30]=a("span",null,"暂未选择任何线路",-1))])):(d(),_("div",xs,[(d(!0),_(x,null,E(i.value,t=>(d(),_("div",{key:t.id,class:"order-item"},[a("div",Es,[a("span",Ms,r(t.name),1),a("div",qs,[e[31]||(e[31]=a("span",{class:"quantity-label"},"数量：",-1)),s(re,{modelValue:t.quantity,"onUpdate:modelValue":y=>t.quantity=y,min:1,max:20,size:"small",class:"quantity-input",onChange:y=>xe(t)},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),a("div",Bs,[a("span",Ns,"￥"+r((W(t,k.value)*t.quantity).toFixed(2)),1),s(f,{type:"text",size:"small",onClick:y=>Ve(t),class:"remove-btn"},{default:o(()=>[s(n,null,{default:o(()=>[s(c(fe))]),_:1})]),_:2},1032,["onClick"])])]))),128))]))]),s(J),a("div",Ls,[a("div",Ss,[e[33]||(e[33]=a("span",{class:"total-label"},"总数量：",-1)),a("span",Us,r(Pe.value)+" 个",1)]),a("div",$s,[e[34]||(e[34]=a("span",{class:"total-label"},"需支付：",-1)),a("span",Ds,"￥"+r(se.value.toFixed(2)),1)])]),a("div",Gs,[e[36]||(e[36]=a("span",{class:"balance-label"},"账户余额：",-1)),a("span",As,"￥"+r((c(A).userInfo.balance||0).toFixed(2)),1),s(Re,{type:"primary",underline:!1,class:"recharge-link",onClick:qe},{default:o(()=>[s(n,null,{default:o(()=>[s(c(oa))]),_:1}),e[35]||(e[35]=I(" 去充值 "))]),_:1,__:[35]})]),s(f,{type:"primary",size:"large",class:"pay-btn",disabled:i.value.length===0,onClick:Me},{default:o(()=>[s(n,null,{default:o(()=>[s(c(ia))]),_:1}),e[37]||(e[37]=I(" 立即支付 "))]),_:1,__:[37]},8,["disabled"])])]),_:1}))],34)])}}},at=ze(Rs,[["__scopeId","data-v-31610297"]]);export{at as default};
