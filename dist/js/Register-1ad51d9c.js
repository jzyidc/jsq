import{_ as S}from"./_plugin-vue_export-helper-e4601500.js";/* empty css                     *//* empty css                    *//* empty css                *//* empty css                 */import{a as N,_ as R,u as $,r as u,$ as h,o as U,c as k,d as z,g as d,i as o,w as l,a0 as M,a1 as D,l as i,D as F,j as I,E as m,a6 as q,a2 as B,a3 as K,q as L,a5 as T,a4 as j}from"./index-cf8bdcfb.js";const G={class:"register-container"},H={class:"register-box"},J={class:"sms-code-container"},O={class:"login-link"},Q={__name:"Register",setup(W){const x=N(),C=R(),y=$(),_=u(),w=u(!1),t=h({PhoneNumber:"",Password:"",Agent:"",SmsCode:"",agree:!1}),g=u(!1),p=u("获取验证码"),f=u(0),P={PhoneNumber:[{validator:(s,e,r)=>{e===""?r(new Error("请输入手机号")):/^1[3-9]\d{9}$/.test(e)?r():r(new Error("请输入正确的手机号格式"))},trigger:"blur"}],Password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],Agent:[{validator:(s,e,r)=>{e===""?r(new Error("请输入代理号")):r()},trigger:"blur"}],SmsCode:[{validator:(s,e,r)=>{e===""?r(new Error("请输入短信验证码")):/^\d{4,6}$/.test(e)?r():r(new Error("请输入正确的验证码格式"))},trigger:"blur"}],agree:[{validator:(s,e,r)=>{e?r():r(new Error("请阅读并同意用户协议和隐私政策"))},trigger:"change"}]},b=async()=>{if(!t.PhoneNumber){m.error("请先输入手机号");return}if(!/^1[3-9]\d{9}$/.test(t.PhoneNumber)){m.error("请输入正确的手机号格式");return}try{const s=await q(t.PhoneNumber);if(s.Code===1e3){g.value=!0,f.value=60;const e=setInterval(()=>{f.value--,p.value=`${f.value}秒后重发`,f.value<=0&&(clearInterval(e),g.value=!1,p.value="获取验证码")},1e3);m.success("验证码已发送")}else{const e=s.Msg||"发送验证码失败";m.error(e)}}catch(s){console.error("发送验证码失败:",s);const e=s.message||"网络连接异常，请稍后重试";m.error(e),g.value=!1,p.value="获取验证码"}};U(()=>{const s=C.query.ref;s&&(t.Agent=s,w.value=!0)});const V=async()=>{if(_.value)try{if(!await _.value.validate())return;const{agree:e,...r}=t,n={Action:"Register",...r};(await y.registerAction(n)).success&&x.push("/login")}catch(s){console.error("注册失败:",s)}};return(s,e)=>{const r=B,n=K,v=L,c=T,E=j,A=D;return k(),z("div",G,[d("div",H,[e[13]||(e[13]=d("div",{class:"register-header"},[d("h2",null,"用户注册"),d("p",null,"创建您的账号")],-1)),o(A,{ref_key:"registerFormRef",ref:_,model:t,rules:P,class:"register-form",onKeyup:M(V,["enter"])},{default:l(()=>[o(n,{prop:"PhoneNumber"},{default:l(()=>[o(r,{modelValue:t.PhoneNumber,"onUpdate:modelValue":e[0]||(e[0]=a=>t.PhoneNumber=a),placeholder:"请输入手机号",size:"large","prefix-icon":"Phone"},null,8,["modelValue"])]),_:1}),o(n,{prop:"Password"},{default:l(()=>[o(r,{modelValue:t.Password,"onUpdate:modelValue":e[1]||(e[1]=a=>t.Password=a),type:"password",placeholder:"请输入密码",size:"large","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),o(n,{prop:"Agent"},{default:l(()=>[o(r,{modelValue:t.Agent,"onUpdate:modelValue":e[2]||(e[2]=a=>t.Agent=a),placeholder:"请输入推荐人",size:"large","prefix-icon":"User",readonly:w.value},null,8,["modelValue","readonly"])]),_:1}),o(n,{prop:"SmsCode"},{default:l(()=>[d("div",J,[o(r,{modelValue:t.SmsCode,"onUpdate:modelValue":e[3]||(e[3]=a=>t.SmsCode=a),placeholder:"请输入短信验证码",size:"large","prefix-icon":"Message",style:{flex:"1","margin-right":"10px"}},null,8,["modelValue"]),o(v,{type:"primary",size:"large",disabled:g.value,onClick:b,style:{width:"120px"}},{default:l(()=>[i(F(p.value),1)]),_:1},8,["disabled"])])]),_:1}),o(n,{prop:"agree"},{default:l(()=>[o(E,{modelValue:t.agree,"onUpdate:modelValue":e[4]||(e[4]=a=>t.agree=a)},{default:l(()=>[e[8]||(e[8]=i(" 我已阅读并同意 ")),o(c,{type:"primary",underline:!1},{default:l(()=>e[6]||(e[6]=[i("《用户协议》")])),_:1,__:[6]}),e[9]||(e[9]=i(" 和 ")),o(c,{type:"primary",underline:!1},{default:l(()=>e[7]||(e[7]=[i("《隐私政策》")])),_:1,__:[7]})]),_:1,__:[8,9]},8,["modelValue"])]),_:1}),o(n,null,{default:l(()=>[o(v,{type:"primary",size:"large",class:"register-button",loading:I(y).loading,onClick:V},{default:l(()=>e[10]||(e[10]=[i(" 注册 ")])),_:1,__:[10]},8,["loading"])]),_:1}),o(n,null,{default:l(()=>[d("div",O,[e[12]||(e[12]=i(" 已有账号？ ")),o(c,{type:"primary",onClick:e[5]||(e[5]=a=>s.$router.push("/login"))},{default:l(()=>e[11]||(e[11]=[i(" 立即登录 ")])),_:1,__:[11]})])]),_:1})]),_:1},8,["model"])])])}}},ne=S(Q,[["__scopeId","data-v-452577d1"]]);export{ne as default};
