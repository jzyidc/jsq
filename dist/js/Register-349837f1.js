import{_ as E}from"./_plugin-vue_export-helper-e4601500.js";/* empty css                     *//* empty css                    *//* empty css                *//* empty css                 */import{a as S,u as A,r as f,a0 as N,c as R,d as h,g as d,i as s,w as l,a1 as U,a2 as $,l as i,B as k,j as z,E as u,a7 as B,a3 as F,a4 as I,q as M,a6 as D,a5 as q}from"./index-53bb2135.js";const K={class:"register-container"},L={class:"register-box"},T={class:"sms-code-container"},j={class:"login-link"},G={__name:"Register",setup(H){const b=S(),y=A(),_=f(),o=N({PhoneNumber:"",Password:"",Agent:"",SmsCode:"",agree:!1}),m=f(!1),g=f("获取验证码"),p=f(0),V={PhoneNumber:[{validator:(t,e,r)=>{e===""?r(new Error("请输入手机号")):/^1[3-9]\d{9}$/.test(e)?r():r(new Error("请输入正确的手机号格式"))},trigger:"blur"}],Password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],Agent:[{validator:(t,e,r)=>{e===""?r(new Error("请输入代理号")):r()},trigger:"blur"}],SmsCode:[{validator:(t,e,r)=>{e===""?r(new Error("请输入短信验证码")):/^\d{4,6}$/.test(e)?r():r(new Error("请输入正确的验证码格式"))},trigger:"blur"}],agree:[{validator:(t,e,r)=>{e?r():r(new Error("请阅读并同意用户协议和隐私政策"))},trigger:"change"}]},x=async()=>{if(!o.PhoneNumber){u.error("请先输入手机号");return}if(!/^1[3-9]\d{9}$/.test(o.PhoneNumber)){u.error("请输入正确的手机号格式");return}try{const t=await B(o.PhoneNumber);if(t.Code===1e3){m.value=!0,p.value=60;const e=setInterval(()=>{p.value--,g.value=`${p.value}秒后重发`,p.value<=0&&(clearInterval(e),m.value=!1,g.value="获取验证码")},1e3);u.success("验证码已发送")}else{const e=t.Msg||"发送验证码失败";u.error(e)}}catch(t){console.error("发送验证码失败:",t);const e=t.message||"网络连接异常，请稍后重试";u.error(e),m.value=!1,g.value="获取验证码"}},w=async()=>{if(_.value)try{if(!await _.value.validate())return;const{agree:e,...r}=o,n={Action:"Register",...r};(await y.registerAction(n)).success&&b.push("/login")}catch(t){console.error("注册失败:",t)}};return(t,e)=>{const r=F,n=I,v=M,c=D,C=q,P=$;return R(),h("div",K,[d("div",L,[e[13]||(e[13]=d("div",{class:"register-header"},[d("h2",null,"用户注册"),d("p",null,"创建您的账号")],-1)),s(P,{ref_key:"registerFormRef",ref:_,model:o,rules:V,class:"register-form",onKeyup:U(w,["enter"])},{default:l(()=>[s(n,{prop:"PhoneNumber"},{default:l(()=>[s(r,{modelValue:o.PhoneNumber,"onUpdate:modelValue":e[0]||(e[0]=a=>o.PhoneNumber=a),placeholder:"请输入手机号",size:"large","prefix-icon":"Phone"},null,8,["modelValue"])]),_:1}),s(n,{prop:"Password"},{default:l(()=>[s(r,{modelValue:o.Password,"onUpdate:modelValue":e[1]||(e[1]=a=>o.Password=a),type:"password",placeholder:"请输入密码",size:"large","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),s(n,{prop:"Agent"},{default:l(()=>[s(r,{modelValue:o.Agent,"onUpdate:modelValue":e[2]||(e[2]=a=>o.Agent=a),placeholder:"请输入推荐人",size:"large","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),s(n,{prop:"SmsCode"},{default:l(()=>[d("div",T,[s(r,{modelValue:o.SmsCode,"onUpdate:modelValue":e[3]||(e[3]=a=>o.SmsCode=a),placeholder:"请输入短信验证码",size:"large","prefix-icon":"Message",style:{flex:"1","margin-right":"10px"}},null,8,["modelValue"]),s(v,{type:"primary",size:"large",disabled:m.value,onClick:x,style:{width:"120px"}},{default:l(()=>[i(k(g.value),1)]),_:1},8,["disabled"])])]),_:1}),s(n,{prop:"agree"},{default:l(()=>[s(C,{modelValue:o.agree,"onUpdate:modelValue":e[4]||(e[4]=a=>o.agree=a)},{default:l(()=>[e[8]||(e[8]=i(" 我已阅读并同意 ")),s(c,{type:"primary",underline:!1},{default:l(()=>e[6]||(e[6]=[i("《用户协议》")])),_:1,__:[6]}),e[9]||(e[9]=i(" 和 ")),s(c,{type:"primary",underline:!1},{default:l(()=>e[7]||(e[7]=[i("《隐私政策》")])),_:1,__:[7]})]),_:1,__:[8,9]},8,["modelValue"])]),_:1}),s(n,null,{default:l(()=>[s(v,{type:"primary",size:"large",class:"register-button",loading:z(y).loading,onClick:w},{default:l(()=>e[10]||(e[10]=[i(" 注册 ")])),_:1,__:[10]},8,["loading"])]),_:1}),s(n,null,{default:l(()=>[d("div",j,[e[12]||(e[12]=i(" 已有账号？ ")),s(c,{type:"primary",onClick:e[5]||(e[5]=a=>t.$router.push("/login"))},{default:l(()=>e[11]||(e[11]=[i(" 立即登录 ")])),_:1,__:[11]})])]),_:1})]),_:1},8,["model"])])])}}},oe=E(G,[["__scopeId","data-v-eeb5e23b"]]);export{oe as default};
