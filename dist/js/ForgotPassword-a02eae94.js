import{_ as V}from"./_plugin-vue_export-helper-f918498f.js";/* empty css                     *//* empty css                *//* empty css                 */import{a as x,r as p,$ as M,c as F,d as $,g as i,i as a,w as t,a0 as z,a1 as R,l as w,D as b,E as d,a7 as I,a8 as S,a2 as B,a3 as D,q as U,a5 as k}from"./index-77fd0c89.js";const L={class:"forgot-password-container"},N={class:"forgot-password-box"},K={class:"sms-code-container"},T={class:"back-to-login"},q={__name:"ForgotPassword",setup(j){const P=x(),g=p(),c=p(!1),o=M({phone:"",smsCode:"",password:"",confirmPassword:""}),u=p(!1),m=p("获取验证码"),f=p(0),y={phone:[{validator:(r,e,s)=>{e===""?s(new Error("请输入手机号")):/^1[3-9]\d{9}$/.test(e)?s():s(new Error("请输入正确的手机号格式"))},trigger:"blur"}],smsCode:[{validator:(r,e,s)=>{e===""?s(new Error("请输入短信验证码")):/^\d{4,6}$/.test(e)?s():s(new Error("请输入正确的验证码格式"))},trigger:"blur"}],password:[{validator:(r,e,s)=>{e===""?s(new Error("请输入新密码")):e.length<6||e.length>20?s(new Error("密码长度在 6 到 20 个字符")):s()},trigger:"blur"}],confirmPassword:[{validator:(r,e,s)=>{e===""?s(new Error("请确认新密码")):e!==o.password?s(new Error("两次输入的密码不一致")):s()},trigger:"blur"}]},C=async()=>{if(!o.phone){d.error("请先输入手机号");return}if(!/^1[3-9]\d{9}$/.test(o.phone)){d.error("请输入正确的手机号格式");return}try{const r=await I(o.phone);if(r.Code===1e3){u.value=!0,f.value=60;const e=setInterval(()=>{f.value--,m.value=`${f.value}秒后重发`,f.value<=0&&(clearInterval(e),u.value=!1,m.value="获取验证码")},1e3);d.success("验证码已发送")}else{const e=r.Msg||r.Message||"发送验证码失败";d.error(e)}}catch(r){console.error("发送验证码失败:",r);const e=r.message||"网络连接异常，请稍后重试";d.error(e),u.value=!1,m.value="获取验证码"}},_=async()=>{if(g.value)try{if(!await g.value.validate())return;c.value=!0;const e={phone:o.phone,password:o.password,smsCode:o.smsCode},s=await S(e);if(s.Code===1e3)d.success("密码重置成功，请使用新密码登录"),P.push("/login");else{const l=s.Msg||s.Message||"密码重置失败";d.error(l)}}catch(r){console.error("重置密码失败:",r);const e=r.message||"网络连接异常，请稍后重试";d.error(e)}finally{c.value=!1}};return(r,e)=>{const s=B,l=D,v=U,h=k,E=R;return F(),$("div",L,[i("div",N,[e[8]||(e[8]=i("div",{class:"forgot-password-header"},[i("h2",null,"重置密码"),i("p",null,"请输入您的手机号码，我们将发送验证码")],-1)),a(E,{ref_key:"forgotPasswordFormRef",ref:g,model:o,rules:y,class:"forgot-password-form",onKeyup:z(_,["enter"])},{default:t(()=>[a(l,{prop:"phone"},{default:t(()=>[a(s,{modelValue:o.phone,"onUpdate:modelValue":e[0]||(e[0]=n=>o.phone=n),placeholder:"请输入手机号",size:"large","prefix-icon":"Phone"},null,8,["modelValue"])]),_:1}),a(l,{prop:"smsCode"},{default:t(()=>[i("div",K,[a(s,{modelValue:o.smsCode,"onUpdate:modelValue":e[1]||(e[1]=n=>o.smsCode=n),placeholder:"请输入短信验证码",size:"large","prefix-icon":"Message",style:{flex:"1","margin-right":"10px"}},null,8,["modelValue"]),a(v,{type:"primary",size:"large",disabled:u.value,onClick:C,style:{width:"120px"}},{default:t(()=>[w(b(m.value),1)]),_:1},8,["disabled"])])]),_:1}),a(l,{prop:"password"},{default:t(()=>[a(s,{modelValue:o.password,"onUpdate:modelValue":e[2]||(e[2]=n=>o.password=n),type:"password",placeholder:"请输入新密码",size:"large","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),a(l,{prop:"confirmPassword"},{default:t(()=>[a(s,{modelValue:o.confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=n=>o.confirmPassword=n),type:"password",placeholder:"请确认新密码",size:"large","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),a(l,null,{default:t(()=>[a(v,{type:"primary",size:"large",class:"reset-button",loading:c.value,onClick:_},{default:t(()=>e[5]||(e[5]=[w(" 重置密码 ")])),_:1,__:[5]},8,["loading"])]),_:1}),a(l,null,{default:t(()=>[i("div",T,[e[7]||(e[7]=w(" 想起密码了？ ")),a(h,{type:"primary",onClick:e[4]||(e[4]=n=>r.$router.push("/login"))},{default:t(()=>e[6]||(e[6]=[w(" 返回登录 ")])),_:1,__:[6]})])]),_:1})]),_:1},8,["model"])])])}}},Z=V(q,[["__scopeId","data-v-a51f68b8"]]);export{Z as default};
