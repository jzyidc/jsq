import{_ as X}from"./_plugin-vue_export-helper-f918498f.js";/* empty css                  *//* empty css                   *//* empty css                             *//* empty css                *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                *//* empty css               */import{r as m,$ as Y,o as Z,c as k,d as D,i as t,w as e,E as f,aI as G,aA as H,g as s,j as w,ag as I,D as n,P as K,aR as N,l as i,aQ as tt,aS as et,k as at,f as P,ar as st,p as ot,aJ as lt,az as nt,q as it,a5 as rt,aX as dt,t as ut,aY as _t,aZ as ct,a_ as mt,a$ as pt,b0 as vt}from"./index-77fd0c89.js";import{f as ft,h as wt}from"./finance-a7731777.js";const gt={class:"order-withdraw-container"},ht={class:"withdraw-content"},bt={class:"stat-item"},yt={class:"stat-icon total"},Ct={class:"stat-content"},kt={class:"stat-value"},Et={class:"stat-item"},xt={class:"stat-icon success"},zt={class:"stat-content"},Dt={class:"stat-value"},St={class:"stat-item"},Ot={class:"stat-icon pending"},Bt={class:"stat-content"},Vt={class:"stat-value"},Tt={class:"stat-item"},It={class:"stat-icon warning"},Nt={class:"stat-content"},Pt={class:"stat-value"},Lt={class:"orders-header"},Mt={class:"header-actions"},$t={class:"table-container"},qt={class:"commission-amount"},jt={key:0,class:"pagination-wrapper"},Rt={key:0,class:"order-detail"},Ut={__name:"OrderWithdraw",setup(Wt){const b=m(!1),E=m(!1),y=m(!1),r=m(null),p=m(1),g=m(20),x=m(0),c=Y({query_total_amount:0,total_commission_amount:0,settled_amount:0,confirming_amount:0,unsettled_amount:0,current_month_amount:0}),S=m([]),h=async()=>{b.value=!0;try{const a=await ft({page:p.value,pageSize:g.value});a.Code===1e3?(Object.assign(c,{query_total_amount:a.query_total_amount||0,total_commission_amount:a.total_commission_amount||0,settled_amount:a.settled_amount||0,confirming_amount:a.confirming_amount||0,unsettled_amount:a.unsettled_amount||0,current_month_amount:a.current_month_amount||0}),S.value=a.List||[],p.value=a.NowPage||1,g.value=a.PageSize||20,x.value=a.RowCount||0):f.error(a.Msg||"获取佣金订单失败")}catch(a){f.error("获取佣金订单失败"),console.error("获取佣金订单失败:",a)}finally{b.value=!1}},d=a=>a==null||a===""?"0.00":parseFloat(a).toFixed(2),L=async()=>{if(c.unsettled_amount<=0){f.warning("暂无可结算的佣金");return}try{await st.confirm(`确认要结算所有未结算订单吗？
结算金额：¥${d(c.unsettled_amount)}`,"确认结算",{confirmButtonText:"确认结算",cancelButtonText:"取消",type:"warning"}),E.value=!0;const a=await wt();a.Code===1e3?(f.success("结算成功"),await h()):f.error(a.Msg||"结算失败")}catch(a){a!=="cancel"&&(f.error("结算失败"),console.error("结算失败:",a))}finally{E.value=!1}},M=a=>{r.value=a,y.value=!0},$=()=>{h()},q=a=>{g.value=a,p.value=1,h()},j=a=>{p.value=a,h()},O=a=>a?new Date(a).toLocaleString("zh-CN"):"-",B=a=>{switch(a){case"已结算":return"success";case"未结算":return"warning";case"结算中":return"primary";case"未提现":return"warning";case"已提现":return"success";case"提现中":return"info";case"提现失败":return"danger";default:return"info"}};return Z(()=>{h()}),(a,o)=>{const v=ot,C=lt,R=nt,z=it,U=rt,u=dt,V=ut,W=_t,A=ct,T=G,_=mt,F=pt,J=H,Q=vt;return k(),D("div",gt,[t(T,{class:"withdraw-card"},{header:e(()=>o[4]||(o[4]=[s("div",{class:"card-header"},[s("h3",null,"订单结算"),s("p",null,"管理您的订单佣金提现")],-1)])),default:e(()=>[s("div",ht,[t(R,{gutter:20,class:"stats-row"},{default:e(()=>[t(C,{xs:24,sm:12,md:6},{default:e(()=>[s("div",bt,[s("div",yt,[t(v,null,{default:e(()=>[t(w(I))]),_:1})]),s("div",Ct,[s("div",kt,"¥"+n(d(c.total_commission_amount)),1),o[5]||(o[5]=s("div",{class:"stat-label"},"总计佣金",-1))])])]),_:1}),t(C,{xs:24,sm:12,md:6},{default:e(()=>[s("div",Et,[s("div",xt,[t(v,null,{default:e(()=>[t(w(K))]),_:1})]),s("div",zt,[s("div",Dt,"¥"+n(d(c.settled_amount)),1),o[6]||(o[6]=s("div",{class:"stat-label"},"已结算佣金",-1))])])]),_:1}),t(C,{xs:24,sm:12,md:6},{default:e(()=>[s("div",St,[s("div",Ot,[t(v,null,{default:e(()=>[t(w(N))]),_:1})]),s("div",Bt,[s("div",Vt,"¥"+n(d(c.confirming_amount)),1),o[7]||(o[7]=s("div",{class:"stat-label"},"结算中佣金",-1))])])]),_:1}),t(C,{xs:24,sm:12,md:6},{default:e(()=>[s("div",Tt,[s("div",It,[t(v,null,{default:e(()=>[t(w(N))]),_:1})]),s("div",Nt,[s("div",Pt,"¥"+n(d(c.unsettled_amount)),1),o[8]||(o[8]=s("div",{class:"stat-label"},"未结算佣金",-1))])])]),_:1})]),_:1}),t(T,{class:"orders-card",shadow:"never"},{header:e(()=>[s("div",Lt,[o[11]||(o[11]=s("h4",null,"佣金订单列表",-1)),s("div",Mt,[t(z,{type:"primary",onClick:L,loading:E.value,disabled:c.unsettled_amount<=0},{default:e(()=>[t(v,null,{default:e(()=>[t(w(I))]),_:1}),o[9]||(o[9]=i(" 一键结算 "))]),_:1,__:[9]},8,["loading","disabled"]),t(z,{onClick:$,loading:b.value},{default:e(()=>[t(v,null,{default:e(()=>[t(w(tt))]),_:1}),o[10]||(o[10]=i(" 刷新 "))]),_:1,__:[10]},8,["loading"])])])]),default:e(()=>[s("div",$t,[et((k(),at(W,{data:S.value,style:{width:"100%"},stripe:""},{default:e(()=>[t(u,{prop:"id",label:"订单ID",width:"120"},{default:e(l=>[t(U,{type:"primary",onClick:At=>M(l.row)},{default:e(()=>[i(n(l.row.id),1)]),_:2},1032,["onClick"])]),_:1}),t(u,{prop:"user_phone",label:"用户手机",width:"130"}),t(u,{prop:"type",label:"类型",width:"100"}),t(u,{prop:"consume_amount",label:"消费金额",width:"120"},{default:e(l=>[i(" ¥"+n(d(l.row.consume_amount)),1)]),_:1}),t(u,{prop:"commission_amount",label:"佣金金额",width:"120"},{default:e(l=>[s("span",qt,"¥"+n(d(l.row.commission_amount)),1)]),_:1}),t(u,{prop:"commission_balance",label:"佣金余额",width:"120"},{default:e(l=>[i(" ¥"+n(d(l.row.commission_balance)),1)]),_:1}),t(u,{prop:"discount",label:"折扣",width:"80"},{default:e(l=>[i(n(l.row.discount),1)]),_:1}),t(u,{prop:"linked_order_consume",label:"关联消费订单",width:"150","show-overflow-tooltip":""}),t(u,{prop:"linked_order_settlement",label:"关联结算订单",width:"150","show-overflow-tooltip":""}),t(u,{prop:"time",label:"订单时间",width:"180"},{default:e(l=>[i(n(O(l.row.time)),1)]),_:1}),t(u,{prop:"status",label:"状态",width:"100"},{default:e(l=>[t(V,{type:B(l.row.status),size:"small"},{default:e(()=>[i(n(l.row.status),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])),[[Q,b.value]]),x.value>0?(k(),D("div",jt,[t(A,{"current-page":p.value,"onUpdate:currentPage":o[0]||(o[0]=l=>p.value=l),"page-size":g.value,"onUpdate:pageSize":o[1]||(o[1]=l=>g.value=l),"page-sizes":[10,20,50,100],total:x.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:q,onCurrentChange:j},null,8,["current-page","page-size","total"])])):P("",!0)])]),_:1})])]),_:1}),t(J,{modelValue:y.value,"onUpdate:modelValue":o[3]||(o[3]=l=>y.value=l),title:"佣金订单详情",width:"700px"},{footer:e(()=>[t(z,{onClick:o[2]||(o[2]=l=>y.value=!1)},{default:e(()=>o[12]||(o[12]=[i("关闭")])),_:1,__:[12]})]),default:e(()=>[r.value?(k(),D("div",Rt,[t(F,{column:2,border:""},{default:e(()=>[t(_,{label:"订单ID"},{default:e(()=>[i(n(r.value.id),1)]),_:1}),t(_,{label:"用户手机"},{default:e(()=>[i(n(r.value.user_phone),1)]),_:1}),t(_,{label:"类型"},{default:e(()=>[i(n(r.value.type),1)]),_:1}),t(_,{label:"消费金额"},{default:e(()=>[i("¥"+n(d(r.value.consume_amount)),1)]),_:1}),t(_,{label:"佣金金额"},{default:e(()=>[i("¥"+n(d(r.value.commission_amount)),1)]),_:1}),t(_,{label:"佣金余额"},{default:e(()=>[i("¥"+n(d(r.value.commission_balance)),1)]),_:1}),t(_,{label:"折扣"},{default:e(()=>[i(n(r.value.discount),1)]),_:1}),t(_,{label:"关联消费订单"},{default:e(()=>[i(n(r.value.linked_order_consume||"-"),1)]),_:1}),t(_,{label:"关联结算订单"},{default:e(()=>[i(n(r.value.linked_order_settlement||"-"),1)]),_:1}),t(_,{label:"订单时间"},{default:e(()=>[i(n(O(r.value.time)),1)]),_:1}),t(_,{label:"状态"},{default:e(()=>[t(V,{type:B(r.value.status)},{default:e(()=>[i(n(r.value.status),1)]),_:1},8,["type"])]),_:1})]),_:1})])):P("",!0)]),_:1},8,["modelValue"])])}}},ne=X(Ut,[["__scopeId","data-v-e2942c66"]]);export{ne as default};
